<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Yuescript | Yuescript</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script>window.global = window;</script>
    <script>
			var Module = {
				onRuntimeInitialized: function() {
					window.yue = Module;
					window.Vue.$data.readonly = false;
					window.Vue.$data.info = Module.version();
				}
			};
		</script>
    <script>
			var Module = {
				onRuntimeInitialized: function() {
					window.yue = Module;
				}
			};
		</script>
    <script src="/js/yuescript.js"></script>
    <meta name="description" content="Documentation">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.fae3671d.css" as="style"><link rel="preload" href="/assets/js/app.6948427c.js" as="script"><link rel="preload" href="/assets/js/3.a65d0947.js" as="script"><link rel="preload" href="/assets/js/13.c43cbcb2.js" as="script"><link rel="preload" href="/assets/js/6.81a4f572.js" as="script"><link rel="preload" href="/assets/js/4.0fd3f51b.js" as="script"><link rel="prefetch" href="/assets/js/1.420bd108.js"><link rel="prefetch" href="/assets/js/10.d839dcab.js"><link rel="prefetch" href="/assets/js/11.1ba335d2.js"><link rel="prefetch" href="/assets/js/12.c82235ec.js"><link rel="prefetch" href="/assets/js/14.8d11df07.js"><link rel="prefetch" href="/assets/js/5.010766f0.js"><link rel="prefetch" href="/assets/js/7.2692e7b8.js"><link rel="prefetch" href="/assets/js/8.59184128.js"><link rel="prefetch" href="/assets/js/9.f6fc9114.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fae3671d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Yuescript</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/doc/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Document
</a></div><div class="nav-item"><a href="/try/" class="nav-link">
  Try yue!
</a></div><div class="nav-item"><a href="https://github.com/pigpigyyy/Yuescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/doc/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Document
</a></div><div class="nav-item"><a href="/try/" class="nav-link">
  Try yue!
</a></div><div class="nav-item"><a href="https://github.com/pigpigyyy/Yuescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Yuescript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc/#introduction" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/#an-overview-of-yuescript" class="sidebar-link">An Overview of Yuescript</a></li></ul></li><li><a href="/doc/#installation" class="sidebar-link">Installation</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#usage" class="sidebar-link">Usage</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#macro" class="sidebar-link">Macro</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/#common-usage" class="sidebar-link">Common Usage</a></li><li class="sidebar-sub-header"><a href="/doc/#insert-raw-codes" class="sidebar-link">Insert Raw  Codes</a></li><li class="sidebar-sub-header"><a href="/doc/#export-macro" class="sidebar-link">Export Macro</a></li></ul></li><li><a href="/doc/#operator" class="sidebar-link">Operator</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/#metatable" class="sidebar-link">Metatable</a></li><li class="sidebar-sub-header"><a href="/doc/#existence" class="sidebar-link">Existence</a></li><li class="sidebar-sub-header"><a href="/doc/#piping" class="sidebar-link">Piping</a></li><li class="sidebar-sub-header"><a href="/doc/#nil-coalescing" class="sidebar-link">Nil Coalescing</a></li><li class="sidebar-sub-header"><a href="/doc/#implicit-object" class="sidebar-link">Implicit Object</a></li></ul></li><li><a href="/doc/#module" class="sidebar-link">Module</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/#import" class="sidebar-link">Import</a></li><li class="sidebar-sub-header"><a href="/doc/#export" class="sidebar-link">Export</a></li></ul></li><li><a href="/doc/#whitespace" class="sidebar-link">Whitespace</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/#multiline-chaining" class="sidebar-link">Multiline Chaining</a></li></ul></li><li><a href="/doc/#assignment" class="sidebar-link">Assignment</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#comment" class="sidebar-link">Comment</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#literals" class="sidebar-link">Literals</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#function-literals" class="sidebar-link">Function Literals</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/#fat-arrows" class="sidebar-link">Fat Arrows</a></li><li class="sidebar-sub-header"><a href="/doc/#argument-defaults" class="sidebar-link">Argument Defaults</a></li><li class="sidebar-sub-header"><a href="/doc/#considerations" class="sidebar-link">Considerations</a></li><li class="sidebar-sub-header"><a href="/doc/#multi-line-arguments" class="sidebar-link">Multi-line arguments</a></li></ul></li><li><a href="/doc/#table-literals" class="sidebar-link">Table Literals</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#comprehensions" class="sidebar-link">Comprehensions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/#list-comprehensions" class="sidebar-link">List Comprehensions</a></li><li class="sidebar-sub-header"><a href="/doc/#table-comprehensions" class="sidebar-link">Table Comprehensions</a></li><li class="sidebar-sub-header"><a href="/doc/#slicing" class="sidebar-link">Slicing</a></li></ul></li><li><a href="/doc/#for-loop" class="sidebar-link">For Loop</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#while-loop" class="sidebar-link">While Loop</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#continue" class="sidebar-link">Continue</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#conditionals" class="sidebar-link">Conditionals</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#if-assignment" class="sidebar-link">If Assignment</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#line-decorators" class="sidebar-link">Line Decorators</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#switch" class="sidebar-link">Switch</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#object-oriented-programming" class="sidebar-link">Object Oriented Programming</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/#inheritance" class="sidebar-link">Inheritance</a></li><li class="sidebar-sub-header"><a href="/doc/#super" class="sidebar-link">Super</a></li><li class="sidebar-sub-header"><a href="/doc/#types" class="sidebar-link">Types</a></li><li class="sidebar-sub-header"><a href="/doc/#class-objects" class="sidebar-link">Class Objects</a></li><li class="sidebar-sub-header"><a href="/doc/#class-variables" class="sidebar-link">Class Variables</a></li><li class="sidebar-sub-header"><a href="/doc/#class-declaration-statements" class="sidebar-link">Class Declaration Statements</a></li><li class="sidebar-sub-header"><a href="/doc/#and-values" class="sidebar-link">@ and @@ Values</a></li><li class="sidebar-sub-header"><a href="/doc/#class-expressions" class="sidebar-link">Class Expressions</a></li><li class="sidebar-sub-header"><a href="/doc/#anonymous-classes" class="sidebar-link">Anonymous classes</a></li></ul></li><li><a href="/doc/#with-statement" class="sidebar-link">With Statement</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#do" class="sidebar-link">Do</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#destructuring-assignment" class="sidebar-link">Destructuring Assignment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/#destructuring-in-other-places" class="sidebar-link">Destructuring In Other Places</a></li></ul></li><li><a href="/doc/#function-stubs" class="sidebar-link">Function Stubs</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#the-using-clause-controlling-destructive-assignment" class="sidebar-link">The Using Clause; Controlling Destructive Assignment</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/doc/#licence-mit" class="sidebar-link">Licence: MIT</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="yuescript"><a href="#yuescript" class="header-anchor">#</a> Yuescript</h1> <img src="/image/yuescript.svg" width="300" height="300" alt="logo"> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Yuescript is a dynamic language that compiles to Lua. And it's a <a href="https://github.com/leafo/moonscript" target="_blank" rel="noopener noreferrer">Moonscript<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> dialect. The codes written in Yuescript are expressive and extremely concise. And it is suitable for writing some changing application logic with more maintainable codes and runs in a Lua embeded environment such as games or website servers.</p> <p>Yue (月) is the name of moon in Chinese and it's pronounced as [jyɛ].</p> <h3 id="an-overview-of-yuescript"><a href="#an-overview-of-yuescript" class="header-anchor">#</a> An Overview of Yuescript</h3> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token comment">-- import syntax</span>
<span class="token keyword">import</span> <span class="token string">&quot;yue&quot;</span> as <span class="token operator">:</span><span class="token property">p</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token property">to_lua</span>

<span class="token comment">-- implicit objects</span>
inventory <span class="token operator">=</span>
  <span class="token property">equipment</span><span class="token operator">:</span>
    <span class="token operator">*</span> <span class="token string">&quot;sword&quot;</span>
    <span class="token operator">*</span> <span class="token string">&quot;shield&quot;</span>
  <span class="token property">items</span><span class="token operator">:</span>
    <span class="token operator">*</span> <span class="token property">name</span><span class="token operator">:</span> <span class="token string">&quot;potion&quot;</span>
      <span class="token property">count</span><span class="token operator">:</span> <span class="token number">10</span>
    <span class="token operator">*</span> <span class="token property">name</span><span class="token operator">:</span> <span class="token string">&quot;bread&quot;</span>
      <span class="token property">count</span><span class="token operator">:</span> <span class="token number">3</span>

<span class="token comment">-- pipe operator</span>
<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
  |<span class="token operator">&gt;</span> map <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-&gt;</span> x <span class="token operator">*</span> <span class="token number">2</span>
  |<span class="token operator">&gt;</span> filter <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-&gt;</span> x <span class="token operator">&gt;</span> <span class="token number">4</span>
  |<span class="token operator">&gt;</span> reduce <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token operator">-&gt;</span> a <span class="token operator">+</span> b
  |<span class="token operator">&gt;</span> <span class="token function">print</span>

<span class="token comment">-- metatable manipulation</span>
apple <span class="token operator">=</span>
  <span class="token property">size</span><span class="token operator">:</span> <span class="token number">15</span>
  index<span class="token operator">#</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">color</span><span class="token operator">:</span> <span class="token number">0x00ffff</span><span class="token punctuation">}</span>
p apple<span class="token punctuation">.</span>color<span class="token punctuation">,</span> apple<span class="token punctuation">.</span>index<span class="token operator">#</span> <span class="token keyword">if</span> apple<span class="token punctuation">.</span><span class="token operator">#</span>?

<span class="token comment">-- js-like export syntax</span>
<span class="token keyword">export</span> yuescript <span class="token operator">=</span> <span class="token string">&quot;月之脚本&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>-- import syntax
import &quot;yue&quot; as :p, :to_lua
-- implicit objects
inventory =
  equipment:
    * &quot;sword&quot;
        * &quot;shield&quot;
    items:
        * name: &quot;potion&quot;
        count: 10
        * name: &quot;bread&quot;
        count: 3

-- pipe operator
{1, 2, 3}
  |&gt; map (x)-&gt; x * 2
  |&gt; filter (x)-&gt; x &gt; 4
  |&gt; reduce 0, (a, b)-&gt; a + b
  |&gt; print

-- metatable manipulation
apple =
  size: 15
  index#: {color: 0x00ffff}
p apple.color, apple.index# if apple.#?

-- js-like export syntax
export yuescript = &quot;月之脚本&quot;
</pre></div></div> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <ul><li><strong>Lua Module</strong></li></ul> <p>  Install <a href="https://luarocks.org" target="_blank" rel="noopener noreferrer">luarocks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, a package manager for Lua modules. Then install it as a Lua module and executable with:</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; luarocks install yuescript
</code></pre></div><p>  Or you can build <code>yue.so</code> file with:</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; make shared LUAI=/usr/local/include/lua LUAL=/usr/local/lib/lua
</code></pre></div><p>  Then get the binary file from path <strong>bin/shared/yue.so</strong>.</p> <ul><li><strong>Binary Tool</strong></li></ul> <p>  Clone this repo, then build and install executable with:</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; make install
</code></pre></div><p>  Build Yuescript tool without macro feature:</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; make install NO_MACRO=true
</code></pre></div><p>  Build Yuescript tool without built-in Lua binary:</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; make install NO_LUA=true
</code></pre></div><h2 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h2> <p>  Require the Yuescript module in Lua:</p> <div class="language-Lua extra-class"><pre class="language-lua"><code><span class="token comment">-- require `main.yue` in Lua</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;yue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">)</span>

<span class="token comment">-- use the Yuescript compiler in Lua</span>
<span class="token keyword">local</span> yue <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;yue&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> codes<span class="token punctuation">,</span> err<span class="token punctuation">,</span> globals <span class="token operator">=</span> yue<span class="token punctuation">.</span><span class="token function">to_lua</span><span class="token punctuation">(</span><span class="token string">[[
f = -&gt;
  print &quot;hello world&quot;
f!
]]</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  implicit_return_root <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
  reserve_line_number <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
  lint_global <span class="token operator">=</span> <span class="token keyword">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>  Use Yuescript tool with:</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; yue -h
Usage: yue [options|files|directories] ...

   -h       Print this message
   -e str   Execute a file or raw codes
   -t path  Specify where to place compiled files
   -o file  Write output to file
   -s       Use spaces in generated codes instead of tabs
   -m       Generate minified codes
   -p       Write output to standard out
   -b       Dump compile time (doesn't write output)
   -l       Write line numbers from source codes
   -v       Print version
   --       Read from standard in, print to standard out
            (Must be first and only argument)

   Execute without options to enter REPL, type symbol '$'
   in a single line to start/stop multi-line mode
</code></pre></div><p>  Use cases:<br>
  Recursively compile every Yuescript file with extension <strong>.yue</strong> under current path:  <strong>yue .</strong><br>
  Compile and save results to a target path:  <strong>yue -t /target/path/ .</strong><br>
  Compile and reserve debug info:  <strong>yue -l .</strong><br>
  Compile and generate minified codes:  <strong>yue -m .</strong><br>
  Execute raw codes:  <strong>yue -e 'print 123'</strong><br>
  Execute a Yuescript file:  <strong>yue -e main.yue</strong></p> <h2 id="macro"><a href="#macro" class="header-anchor">#</a> Macro</h2> <h3 id="common-usage"><a href="#common-usage" class="header-anchor">#</a> Common Usage</h3> <p>Macro function is used for evaluating a string in the compile time and insert the generated codes into final compilation.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>macro <span class="token class-name">PI2</span> <span class="token operator">=</span> <span class="token operator">-&gt;</span> <span class="token function">math<span class="token punctuation">.</span>pi</span> <span class="token operator">*</span> <span class="token number">2</span>
area <span class="token operator">=</span> $<span class="token class-name">PI2</span> <span class="token operator">*</span> <span class="token number">5</span>

macro <span class="token class-name">HELLO</span> <span class="token operator">=</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;'hello world'&quot;</span>
<span class="token function">print</span> $<span class="token class-name">HELLO</span>

macro config <span class="token operator">=</span> <span class="token punctuation">(</span>debugging<span class="token punctuation">)</span><span class="token operator">-&gt;</span>
  global debugMode <span class="token operator">=</span> debugging <span class="token operator">==</span> <span class="token string">&quot;true&quot;</span>
  <span class="token string">&quot;&quot;</span>

macro asserts <span class="token operator">=</span> <span class="token punctuation">(</span>cond<span class="token punctuation">)</span><span class="token operator">-&gt;</span>
  debugMode <span class="token operator">and</span> <span class="token string">&quot;assert <span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">cond</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span> <span class="token operator">or</span> <span class="token string">&quot;&quot;</span>

macro <span class="token function">assert</span> <span class="token operator">=</span> <span class="token punctuation">(</span>cond<span class="token punctuation">)</span><span class="token operator">-&gt;</span>
  debugMode <span class="token operator">and</span> <span class="token string">&quot;assert <span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">cond</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span> <span class="token operator">or</span> <span class="token string">&quot;<span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">cond</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span>

$config <span class="token boolean">true</span>
$asserts item <span class="token operator">~=</span> <span class="token keyword">nil</span>

$config <span class="token boolean">false</span>
value <span class="token operator">=</span> $<span class="token function">assert</span> item

<span class="token comment">-- the passed expressions are treated as strings</span>
macro <span class="token operator">and</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token string">&quot;#{ table.concat {...}, ' and ' }&quot;</span>
<span class="token keyword">if</span> $<span class="token operator">and</span> f1<span class="token operator">!</span><span class="token punctuation">,</span> f2<span class="token operator">!</span><span class="token punctuation">,</span> f3<span class="token operator">!</span>
  <span class="token function">print</span> <span class="token string">&quot;OK&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>macro PI2 = -&gt; math.pi * 2
area = $PI2 * 5

macro HELLO = -&gt; &quot;'hello world'&quot;
print $HELLO

macro config = (debugging)-&gt;
  global debugMode = debugging == &quot;true&quot;
  &quot;&quot;

macro asserts = (cond)-&gt;
  debugMode and &quot;assert #{cond}&quot; or &quot;&quot;

macro assert = (cond)-&gt;
  debugMode and &quot;assert #{cond}&quot; or &quot;#{cond}&quot;

$config true
$asserts item ~= nil

$config false
value = $assert item

-- the passed expressions are treated as strings
macro and = (...)-&gt; &quot;#{ table.concat {...}, ' and ' }&quot;
if $and f1!, f2!, f3!
  print &quot;OK&quot;
</pre></div></div> <h3 id="insert-raw-codes"><a href="#insert-raw-codes" class="header-anchor">#</a> Insert Raw  Codes</h3> <p>A macro function can either return a Yuescript string or a config table containing Lua codes.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>macro yueFunc <span class="token operator">=</span> <span class="token punctuation">(</span>var<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token string">&quot;local <span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">var</span><span class="token interpolation-punctuation punctuation">}</span></span> = -&gt;&quot;</span>
$yueFunc funcA
funcA <span class="token operator">=</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;assign the Yue defined variable&quot;</span>

<span class="token comment">-- take care and let Yuescript know the</span>
<span class="token comment">-- local variables you declared in Lua code</span>
macro luaFunc <span class="token operator">=</span> <span class="token punctuation">(</span>var<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
  <span class="token property">code</span><span class="token operator">:</span> <span class="token string">&quot;local function <span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">var</span><span class="token interpolation-punctuation punctuation">}</span></span>() end&quot;</span>
  <span class="token property">type</span><span class="token operator">:</span> <span class="token string">&quot;lua&quot;</span>
  <span class="token property">locals</span><span class="token operator">:</span> <span class="token punctuation">{</span>var<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
$luaFunc funcB
funcB <span class="token operator">=</span> <span class="token operator">-&gt;</span> <span class="token string">&quot;assign the Lua defined variable&quot;</span>

macro lua <span class="token operator">=</span> <span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
  <span class="token operator">:</span><span class="token property">code</span>
  <span class="token property">type</span><span class="token operator">:</span> <span class="token string">&quot;lua&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">-- the raw string leading and ending symbols are auto trimed</span>
$lua<span class="token string">[==[
-- raw Lua codes insertion
if cond then
  print(&quot;output&quot;)
end
]==]</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>macro yueFunc = (var)-&gt; &quot;local #{var} = -&gt;&quot;
$yueFunc funcA
funcA = -&gt; &quot;assign the Yue defined variable&quot;

-- take care and let Yuescript know the
-- local variables you declared in Lua codes
macro luaFunc = (var)-&gt; {
  code: &quot;local function #{var}() end&quot;
  type: &quot;lua&quot;
  locals: {var}
}
$luaFunc funcB
funcB = -&gt; &quot;assign the Lua defined variable&quot;

macro lua = (code)-&gt; {
  :code
  type: &quot;lua&quot;
}

-- the raw string leading and ending symbols are auto trimed
$lua[==[
-- raw Lua codes insertion
if cond then
  print(&quot;output&quot;)
end
]==]
</pre></div></div> <h3 id="export-macro"><a href="#export-macro" class="header-anchor">#</a> Export Macro</h3> <p>Macro functions can be exported from a module and get imported in another module. It is recommanded to export macro functions in a single file to speed up compilation.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token comment">-- file: utils.yue</span>
<span class="token keyword">export</span> macro map <span class="token operator">=</span> <span class="token punctuation">(</span>items<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token string">&quot;[<span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">action</span><span class="token interpolation-punctuation punctuation">}</span></span> for _ in *<span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">items</span><span class="token interpolation-punctuation punctuation">}</span></span>]&quot;</span>
<span class="token keyword">export</span> macro filter <span class="token operator">=</span> <span class="token punctuation">(</span>items<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token string">&quot;[_ for _ in *<span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">items</span><span class="token interpolation-punctuation punctuation">}</span></span> when <span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">action</span><span class="token interpolation-punctuation punctuation">}</span></span>]&quot;</span>
<span class="token keyword">export</span> macro foreach <span class="token operator">=</span> <span class="token punctuation">(</span>items<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token string">&quot;for _ in *<span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">items</span><span class="token interpolation-punctuation punctuation">}</span></span>
  <span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript">action</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span>

<span class="token comment">-- file main.yue</span>
<span class="token keyword">import</span> <span class="token string">&quot;utils&quot;</span> as <span class="token punctuation">{</span>
  $<span class="token punctuation">,</span> <span class="token comment">-- symbol to import all macros</span>
  $<span class="token property">foreach</span><span class="token operator">:</span> $each <span class="token comment">-- rename macro $foreach to $each</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span> |<span class="token operator">&gt;</span> $map<span class="token punctuation">(</span>_ <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> |<span class="token operator">&gt;</span> $filter<span class="token punctuation">(</span>_ <span class="token operator">&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> |<span class="token operator">&gt;</span> $each <span class="token function">print</span> _
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>-- file: utils.yue
export macro map = (items, action)-&gt; &quot;[#{action} for _ in *#{items}]&quot;
export macro filter = (items, action)-&gt; &quot;[_ for _ in *#{items} when #{action}]&quot;
export macro foreach = (items, action)-&gt; &quot;for _ in *#{items}
  #{action}&quot;
-- file main.yue
-- import function is not available in browser, try it in a real environment
--[[
import &quot;utils&quot; as {
  $, -- symbol to import all macros
  $foreach: $each -- rename macro $foreach to $each
}
{1, 2, 3} |&gt; $map(_ * 2) |&gt; $filter(_ &gt; 4) |&gt; $each print _
]]
</pre></div></div> <h2 id="operator"><a href="#operator" class="header-anchor">#</a> Operator</h2> <p>All of Lua's binary and unary operators are available. Additionally <strong>!=</strong> is as an alias for <strong>~=</strong>, and either <strong>\</strong> or <strong>::</strong> can be used to write a chaining function call like <code>tb\func!</code> or <code>tb::func!</code>. And Yuescipt offers some other special operators to write more expressive codes.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>tb<span class="token punctuation">\</span>func<span class="token operator">!</span> <span class="token keyword">if</span> tb <span class="token operator">~=</span> <span class="token keyword">nil</span>
<span class="token property">tb</span><span class="token operator">:</span><span class="token operator">:</span><span class="token property">func</span><span class="token operator">!</span> <span class="token keyword">if</span> tb <span class="token operator">!=</span> <span class="token keyword">nil</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>tb\func! if tb ~= nil
tb::func! if tb != nil
</pre></div></div> <h3 id="metatable"><a href="#metatable" class="header-anchor">#</a> Metatable</h3> <p>The <strong>#</strong> operator can be used as a shortcut for metatable manipulation.</p> <ul><li><strong>Metatable Creation</strong><br>
Create normal table with  key <strong>#</strong> or metamethod key that ends with <strong>#</strong>.</li></ul> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>mt <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
add <span class="token operator">=</span> <span class="token punctuation">(</span>right<span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token operator">#</span><span class="token operator">:</span> mt<span class="token punctuation">,</span> <span class="token property">value</span><span class="token operator">:</span> <span class="token variable">@value</span> <span class="token operator">+</span> right<span class="token punctuation">.</span>value
mt<span class="token punctuation">.</span>__add <span class="token operator">=</span> add

a <span class="token operator">=</span> <span class="token operator">#</span><span class="token operator">:</span> mt<span class="token punctuation">,</span> <span class="token property">value</span><span class="token operator">:</span> <span class="token number">1</span>
 <span class="token comment">-- set field with variable of the same name</span>
b <span class="token operator">=</span> <span class="token operator">:</span><span class="token property">add</span><span class="token operator">#</span><span class="token punctuation">,</span> <span class="token property">value</span><span class="token operator">:</span> <span class="token number">2</span>
c <span class="token operator">=</span> add<span class="token operator">#</span><span class="token operator">:</span> mt<span class="token punctuation">.</span>__add<span class="token punctuation">,</span> <span class="token property">value</span><span class="token operator">:</span> <span class="token number">3</span>

d <span class="token operator">=</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c
<span class="token function">print</span> d<span class="token punctuation">.</span>value

close _ <span class="token operator">=</span> close<span class="token operator">#</span><span class="token operator">:</span> <span class="token operator">-&gt;</span> <span class="token function">print</span> <span class="token string">&quot;out of scope&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>mt = {}
add = (right)=&gt; #: mt, value: @value + right.value
mt.__add = add

a = #: mt, value: 1
 -- set field with variable of the same name
b = :add#, value: 2
c = add#: mt.__add, value: 3

d = a + b + c
print d.value

close _ = close#: -&gt; print &quot;out of scope&quot;
</pre></div></div> <ul><li><strong>Metatable Accessing</strong><br>
Accessing metatable with key <strong>#</strong> or metamethod key that ends with <strong>#</strong>.</li></ul> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token comment">-- create with metatable containing field &quot;value&quot;</span>
tb <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token operator">#</span><span class="token operator">:</span> <span class="token number">123</span>
tb<span class="token punctuation">.</span>index<span class="token operator">#</span> <span class="token operator">=</span> tb<span class="token punctuation">.</span><span class="token operator">#</span>
<span class="token function">print</span> tb<span class="token punctuation">.</span>value

tb<span class="token punctuation">.</span><span class="token operator">#</span> <span class="token operator">=</span> <span class="token property">__index</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">item</span><span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">}</span>
<span class="token function">print</span> tb<span class="token punctuation">.</span>item
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>-- create with metatable containing field &quot;value&quot;
tb = [&quot;value&quot;]#: 123
tb.index# = tb.#
print tb.value
tb.# = __index: {item: &quot;hello&quot;}
print tb.item
</pre></div></div> <ul><li><strong>Metatable Destructure</strong><br>
Destruct metatable with metamethod key that ends with <strong>#</strong>.</li></ul> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token punctuation">{</span>item<span class="token punctuation">,</span> <span class="token operator">:</span><span class="token property">new</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token property">close</span><span class="token operator">#</span><span class="token punctuation">,</span> index<span class="token operator">#</span><span class="token operator">:</span> getter<span class="token punctuation">}</span> <span class="token operator">=</span> tb
<span class="token function">print</span> item<span class="token punctuation">,</span> new<span class="token punctuation">,</span> close<span class="token punctuation">,</span> getter
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>{item, :new, :close#, index#: getter} = tb
print item, new, close, getter
</pre></div></div> <h3 id="existence"><a href="#existence" class="header-anchor">#</a> Existence</h3> <p>The <strong>?</strong> operator can be used in a variety of contexts to check for existence.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>func?<span class="token operator">!</span>
<span class="token function">print</span> abc?<span class="token punctuation">[</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">]</span>?<span class="token punctuation">.</span>xyz

x <span class="token operator">=</span> tab?<span class="token punctuation">.</span>value
len <span class="token operator">=</span> utf8?<span class="token punctuation">.</span>len <span class="token operator">or</span> string?<span class="token punctuation">.</span>len <span class="token operator">or</span> <span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token operator">#</span>o

<span class="token keyword">if</span> <span class="token function">print</span> <span class="token operator">and</span> x?
  <span class="token function">print</span> x

<span class="token keyword">with</span>? <span class="token function">io<span class="token punctuation">.</span>open</span> <span class="token string">&quot;test.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span>
  <span class="token punctuation">\</span>write <span class="token string">&quot;hello&quot;</span>
  <span class="token punctuation">\</span>close<span class="token operator">!</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>func?!
print abc?[&quot;hello world&quot;]?.xyz

x = tab?.value
len = utf8?.len or string?.len or (o)-&gt; #o

if print and x?
  print x

with? io.open &quot;test.txt&quot;, &quot;w&quot;
  \write &quot;hello&quot;
  \close!
</pre></div></div> <h3 id="piping"><a href="#piping" class="header-anchor">#</a> Piping</h3> <p>Instead of a series of nested function calls, you can pipe values with operator <strong>|&gt;</strong>.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token string">&quot;hello&quot;</span> |<span class="token operator">&gt;</span> <span class="token function">print</span>
<span class="token number">1</span> |<span class="token operator">&gt;</span> <span class="token function">print</span> <span class="token number">2</span> <span class="token comment">-- insert pipe item as the first argument</span>
<span class="token number">2</span> |<span class="token operator">&gt;</span> <span class="token function">print</span> <span class="token number">1</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token number">3</span> <span class="token comment">-- pipe with a placeholder</span>

<span class="token comment">-- pipe expression in multiline</span>
readFile <span class="token string">&quot;example.txt&quot;</span>
  |<span class="token operator">&gt;</span> extract language<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  |<span class="token operator">&gt;</span> parse language
  |<span class="token operator">&gt;</span> emit
  |<span class="token operator">&gt;</span> render
  |<span class="token operator">&gt;</span> <span class="token function">print</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>&quot;hello&quot; |&gt; print
1 |&gt; print 2 -- insert pipe item as the first argument
2 |&gt; print 1, _, 3 -- pipe with a placeholder

-- pipe expression in multiline
readFile &quot;example.txt&quot;
  |&gt; extract language, {}
  |&gt; parse language
  |&gt; emit
  |&gt; render
  |&gt; print
</pre></div></div> <h3 id="nil-coalescing"><a href="#nil-coalescing" class="header-anchor">#</a> Nil Coalescing</h3> <p>The nil-coalescing operator <strong>??</strong> returns the value of its left-hand operand if it isn't <strong>nil</strong>; otherwise, it evaluates the right-hand operand and returns its result. The <strong>??</strong> operator doesn't evaluate its right-hand operand if the left-hand operand evaluates to non-nil.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">local</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d
a <span class="token operator">=</span> b ?? c ?? d
func a ?? <span class="token punctuation">{</span><span class="token punctuation">}</span>

a ??<span class="token operator">=</span> <span class="token boolean">false</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>local a, b, c, d
a = b ?? c ?? d
func a ?? {}
a ??= false
</pre></div></div> <h3 id="implicit-object"><a href="#implicit-object" class="header-anchor">#</a> Implicit Object</h3> <p>You can write a list of implicit structures that starts with the symbol <strong>*</strong> inside a table block. If you are creating implicit object, the fields of the object must be with the same indent.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>list <span class="token operator">=</span>
  <span class="token operator">*</span> <span class="token number">1</span>
  <span class="token operator">*</span> <span class="token number">2</span>
  <span class="token operator">*</span> <span class="token number">3</span>

func
  <span class="token operator">*</span> <span class="token number">1</span>
  <span class="token operator">*</span> <span class="token number">2</span>
  <span class="token operator">*</span> <span class="token number">3</span>

tb <span class="token operator">=</span>
  <span class="token property">name</span><span class="token operator">:</span> <span class="token string">&quot;abc&quot;</span>

  <span class="token property">values</span><span class="token operator">:</span>
    <span class="token operator">*</span> <span class="token string">&quot;a&quot;</span>
    <span class="token operator">*</span> <span class="token string">&quot;b&quot;</span>
    <span class="token operator">*</span> <span class="token string">&quot;c&quot;</span>

  <span class="token property">objects</span><span class="token operator">:</span>
    <span class="token operator">*</span> <span class="token property">name</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span>
      <span class="token property">value</span><span class="token operator">:</span> <span class="token number">1</span>
      <span class="token property">func</span><span class="token operator">:</span> <span class="token operator">=&gt;</span> <span class="token variable">@value</span> <span class="token operator">+</span> <span class="token number">1</span>
      <span class="token property">tb</span><span class="token operator">:</span>
        <span class="token property">fieldA</span><span class="token operator">:</span> <span class="token number">1</span>

    <span class="token operator">*</span> <span class="token property">name</span><span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
      <span class="token property">value</span><span class="token operator">:</span> <span class="token number">2</span>
      <span class="token property">func</span><span class="token operator">:</span> <span class="token operator">=&gt;</span> <span class="token variable">@value</span> <span class="token operator">+</span> <span class="token number">2</span>
      <span class="token property">tb</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>list =
  * 1
  * 2
  * 3

func
  * 1
  * 2
  * 3

tb =
  name: &quot;abc&quot;

  values:
    * &quot;a&quot;
    * &quot;b&quot;
    * &quot;c&quot;

  objects:
    * name: &quot;a&quot;
      value: 1
      func: =&gt; @value + 1
      tb:
        fieldA: 1

    * name: &quot;b&quot;
      value: 2
      func: =&gt; @value + 2
      tb: { }
</pre></div></div> <h2 id="module"><a href="#module" class="header-anchor">#</a> Module</h2> <h3 id="import"><a href="#import" class="header-anchor">#</a> Import</h3> <p>The import statement is a syntax sugar for requiring a module or help extracting items from an imported module.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token comment">-- used as table destructure</span>
<span class="token keyword">do</span>
  <span class="token keyword">import</span> <span class="token class-name">C</span><span class="token punctuation">,</span> <span class="token class-name">Ct</span><span class="token punctuation">,</span> <span class="token class-name">Cmt</span> <span class="token keyword">from</span> <span class="token function">require</span> <span class="token string">&quot;lpeg&quot;</span>
  <span class="token keyword">import</span> insert<span class="token punctuation">,</span> concat <span class="token keyword">from</span> table

<span class="token comment">-- shortcut for requring a module</span>
<span class="token keyword">do</span>
  <span class="token keyword">import</span> <span class="token string">'module'</span>
  <span class="token keyword">import</span> <span class="token string">'module_x'</span>
  <span class="token keyword">import</span> <span class="token string">&quot;d-a-s-h-e-s&quot;</span>
  <span class="token keyword">import</span> <span class="token string">&quot;module.part&quot;</span>

<span class="token comment">-- requring module with aliasing or table destruction</span>
<span class="token keyword">do</span>
  <span class="token keyword">import</span> <span class="token string">&quot;player&quot;</span> as <span class="token class-name">PlayerModule</span>
  <span class="token keyword">import</span> <span class="token string">&quot;lpeg&quot;</span> as <span class="token operator">:</span><span class="token class-name">C</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token class-name">Ct</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token class-name">Cmt</span>
  <span class="token keyword">import</span> <span class="token string">&quot;export&quot;</span> as <span class="token punctuation">{</span>one<span class="token punctuation">,</span> two<span class="token punctuation">,</span> <span class="token class-name">Something</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">umm</span><span class="token operator">:</span><span class="token punctuation">{</span>ch<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>-- used as table destruction
do
  import C, Ct, Cmt from require &quot;lpeg&quot;
  import insert, concat from table

-- shortcut for requring a module
do
  import 'module'
  import 'module_x'
  import &quot;d-a-s-h-e-s&quot;
  import &quot;module.part&quot;

-- requring module with aliasing or table destruction
do
  import &quot;player&quot; as PlayerModule
  import &quot;lpeg&quot; as :C, :Ct, :Cmt
  import &quot;export&quot; as {one, two, Something:{umm:{ch}}}
</pre></div></div> <h3 id="export"><a href="#export" class="header-anchor">#</a> Export</h3> <p>The export statement offers a concise way to define modules.</p> <ul><li><strong>Named Export</strong><br>
Named export will define a local variable as well as adding a field in the exported table.</li></ul> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">export</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span>
<span class="token keyword">export</span> cool <span class="token operator">=</span> <span class="token string">&quot;cat&quot;</span>

<span class="token keyword">export</span> <span class="token class-name">What</span> <span class="token operator">=</span> <span class="token keyword">if</span> this
  <span class="token string">&quot;abc&quot;</span>
<span class="token keyword">else</span>
  <span class="token string">&quot;def&quot;</span>

<span class="token keyword">export</span> y <span class="token operator">=</span> <span class="token operator">-&gt;</span>
  hallo <span class="token operator">=</span> <span class="token number">3434</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Something</span>
  <span class="token property">umm</span><span class="token operator">:</span> <span class="token string">&quot;cool&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>export a, b, c = 1, 2, 3
export cool = &quot;cat&quot;

export What = if this
  &quot;abc&quot;
else
  &quot;def&quot;

export y = -&gt;
  hallo = 3434

export class Something
  umm: &quot;cool&quot;
</pre></div></div> <ul><li><strong>Unnamed Export</strong><br>
Unnamed export will add the target item into the array part of the exported table.</li></ul> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span>
<span class="token keyword">export</span> d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f

<span class="token keyword">export</span> <span class="token keyword">if</span> this
  <span class="token number">123</span>
<span class="token keyword">else</span>
  <span class="token number">456</span>

<span class="token keyword">export</span> <span class="token keyword">with</span> tmp
  j <span class="token operator">=</span> <span class="token number">2000</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>d, e, f = 3, 2, 1
export d, e, f

export if this
  123
else
  456

export with tmp
  j = 2000
</pre></div></div> <ul><li><strong>Default Export</strong><br>
Using the <strong>default</strong> keyword in export statement to replace the exported table with any thing.</li></ul> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">export</span> default <span class="token operator">-&gt;</span>
  <span class="token function">print</span> <span class="token string">&quot;hello&quot;</span>
  <span class="token number">123</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>export default -&gt;
  print &quot;hello&quot;
  123
</pre></div></div> <h2 id="whitespace"><a href="#whitespace" class="header-anchor">#</a> Whitespace</h2> <p>Yuescript is a whitespace significant language. You have to write some code block in the same indent with space <strong>' '</strong> or tab <strong>'\t'</strong> like function body, value list and some control blocks. And expressions containing different whitespaces might mean different things. Tab is treated like 4 space, but it's better not mix the use of spaces and tabs.</p> <h3 id="multiline-chaining"><a href="#multiline-chaining" class="header-anchor">#</a> Multiline Chaining</h3> <p>You can write multi-line chaining function calls with a same indent.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token class-name">Rx</span><span class="token punctuation">.</span><span class="token class-name">Observable</span>
  <span class="token punctuation">.</span>fromRange <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span>
  <span class="token punctuation">\</span>filter <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-&gt;</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span>
  <span class="token punctuation">\</span>concat <span class="token class-name">Rx</span><span class="token punctuation">.</span><span class="token class-name">Observable</span><span class="token punctuation">.</span>of <span class="token string">'who do we appreciate'</span>
  <span class="token punctuation">\</span>map <span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token operator">-&gt;</span> value <span class="token operator">..</span> <span class="token string">'!'</span>
  <span class="token punctuation">\</span>subscribe <span class="token function">print</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>Rx.Observable
  .fromRange 1, 8
  \filter (x)-&gt; x % 2 == 0
  \concat Rx.Observable.of 'who do we appreciate'
  \map (value)-&gt; value .. '!'
  \subscribe print
</pre></div></div> <h2 id="assignment"><a href="#assignment" class="header-anchor">#</a> Assignment</h2> <p>The variable is dynamic typed and is defined as local by default. But you can change the scope of declaration by <strong>local</strong> and <strong>global</strong> statement.</p> <ul><li><strong>Common Use</strong></li></ul> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>hello <span class="token operator">=</span> <span class="token string">&quot;world&quot;</span>
a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span>
hello <span class="token operator">=</span> <span class="token number">123</span> <span class="token comment">-- uses the existing variable</span>

<span class="token comment">-- update Assignment</span>
x <span class="token operator">=</span> <span class="token number">0</span>
x <span class="token operator">+=</span> <span class="token number">10</span>

s <span class="token operator">=</span> <span class="token string">&quot;hello &quot;</span>
s <span class="token operator">..=</span> <span class="token string">&quot;world&quot;</span>

arg <span class="token operator">or=</span> <span class="token string">&quot;default value&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>hello = &quot;world&quot;
a, b, c = 1, 2, 3
hello = 123 -- uses the existing variable

-- update Assignment
x = 0
x += 10

s = &quot;hello &quot;
s ..= &quot;world&quot;

arg or= &quot;default value&quot;
</pre></div></div> <ul><li><strong>Explicit Locals</strong></li></ul> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">do</span>
  <span class="token keyword">local</span> <span class="token operator">*</span>
  <span class="token function">print</span> <span class="token string">&quot;forward declare all variables as locals&quot;</span>
  x <span class="token operator">=</span> <span class="token operator">-&gt;</span> <span class="token number">1</span> <span class="token operator">+</span> y <span class="token operator">+</span> z
  y<span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span>
  global instance <span class="token operator">=</span> <span class="token class-name">Item</span><span class="token punctuation">\</span>new<span class="token operator">!</span>

<span class="token keyword">do</span>
  <span class="token keyword">local</span> <span class="token operator">^</span>
  <span class="token function">print</span> <span class="token string">&quot;only forward declare upper case variables&quot;</span>
  a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token class-name">B</span> <span class="token operator">=</span> <span class="token number">2</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>do
  local *
  print &quot;forward declare all variables as locals&quot;
  x = -&gt; 1 + y + z
  y, z = 2, 3
  global instance = Item\new!

do
  local ^
  print &quot;only forward declare upper case variables&quot;
  a = 1
  B = 2
</pre></div></div> <ul><li><strong>Explicit Globals</strong></li></ul> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">do</span>
  global <span class="token operator">*</span>
  <span class="token function">print</span> <span class="token string">&quot;declare all variables as globals&quot;</span>
  x <span class="token operator">=</span> <span class="token operator">-&gt;</span> <span class="token number">1</span> <span class="token operator">+</span> y <span class="token operator">+</span> z
  y<span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span>

<span class="token keyword">do</span>
  global <span class="token operator">^</span>
  <span class="token function">print</span> <span class="token string">&quot;only declare upper case variables as globals&quot;</span>
  a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token class-name">B</span> <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">local</span> <span class="token class-name">Temp</span> <span class="token operator">=</span> <span class="token string">&quot;a local value&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>do
  global *
  print &quot;declare all variables as globals&quot;
  x = -&gt; 1 + y + z
  y, z = 2, 3

do
  global ^
  print &quot;only declare upper case variables as globals&quot;
  a = 1
  B = 2
  local Temp = &quot;a local value&quot;
</pre></div></div> <h2 id="comment"><a href="#comment" class="header-anchor">#</a> Comment</h2> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token comment">-- I am a comment</span>

str <span class="token operator">=</span> <span class="token comment">--[[</span>
<span class="token class-name">This</span> is a multi<span class="token operator">-</span>line comment<span class="token punctuation">.</span>
<span class="token class-name">It</span>'s <span class="token class-name">OK</span><span class="token punctuation">.</span>
<span class="token punctuation">]</span><span class="token punctuation">]</span> strA <span class="token punctuation">\</span> <span class="token comment">-- comment 1</span>
  <span class="token operator">..</span> strB <span class="token punctuation">\</span> <span class="token comment">-- comment 2</span>
  <span class="token operator">..</span> strC

func <span class="token comment">--[[port]] 3000, --[[ip]] &quot;192.168.1.1&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>-- I am a comment

str = --[[
This is a multi-line comment.
It's OK.
]] strA \ -- comment 1
  .. strB \ -- comment 2
  .. strC

func --[[port]] 3000, --[[ip]] &quot;192.168.1.1&quot;
</pre></div></div> <div class="custom-block warning"><p class="custom-block-title">NOTICE</p> <p>The rest of the document is describing mostly the same syntax taken from Moonscript. So you may as well refer to the <a href="http://moonscript.org/reference" target="_blank" rel="noopener noreferrer">Moonscript Reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to get the same explanation.</p></div> <h2 id="literals"><a href="#literals" class="header-anchor">#</a> Literals</h2> <p>All of the primitive literals in Lua can be used. This applies to numbers, strings, booleans, and <strong>nil</strong>.</p> <p>Unlike Lua, Line breaks are allowed inside of single and double quote strings without an escape sequence:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>some_string <span class="token operator">=</span> <span class="token string">&quot;Here is a string
  that has a line break in it.&quot;</span>

<span class="token comment">-- You can mix expressions into string literals using #{} syntax.</span>
<span class="token function">print</span> <span class="token string">&quot;I am <span class="token interpolation"><span class="token interpolation-punctuation punctuation">#{</span><span class="token moonscript"><span class="token function">math<span class="token punctuation">.</span>random</span><span class="token operator">!</span> <span class="token operator">*</span> <span class="token number">100</span></span><span class="token interpolation-punctuation punctuation">}</span></span>% sure.&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>some_string = &quot;Here is a string
  that has a line break in it.&quot;

-- You can mix expressions into string literals using #{} syntax.
print &quot;I am #{math.random! * 100}% sure.&quot;
</pre></div></div> <h2 id="function-literals"><a href="#function-literals" class="header-anchor">#</a> Function Literals</h2> <p>All functions are created using a function expression. A simple function is denoted using the arrow: <strong>-&gt;</strong>.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>my_function <span class="token operator">=</span> <span class="token operator">-&gt;</span>
my_function<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- call the empty function</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>my_function = -&gt;
my_function() -- call the empty function
</pre></div></div> <p>The body of the function can either be one statement placed directly after the arrow, or it can be a series of statements indented on the following lines:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>func_a <span class="token operator">=</span> <span class="token operator">-&gt;</span> <span class="token function">print</span> <span class="token string">&quot;hello world&quot;</span>

func_b <span class="token operator">=</span> <span class="token operator">-&gt;</span>
  value <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token function">print</span> <span class="token string">&quot;The value:&quot;</span><span class="token punctuation">,</span> value
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>func_a = -&gt; print &quot;hello world&quot;

func_b = -&gt;
  value = 100
  print &quot;The value:&quot;, value
</pre></div></div> <p>If a function has no arguments, it can be called using the ! operator, instead of empty parentheses. The ! invocation is the preferred way to call functions with no arguments.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>func_a<span class="token operator">!</span>
func_b<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>func_a!
func_b()
</pre></div></div> <p>Functions with arguments can be created by preceding the arrow with a list of argument names in parentheses:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>sum <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token function">print</span> <span class="token string">&quot;sum&quot;</span><span class="token punctuation">,</span> x <span class="token operator">+</span> y
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>sum = (x, y)-&gt; print &quot;sum&quot;, x + y
</pre></div></div> <p>Functions can be called by listing the arguments after the name of an expression that evaluates to a function. When chaining together function calls, the arguments are applied to the closest function to the left.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>sum <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span>
<span class="token function">print</span> sum <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span>

a b c <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>sum 10, 20
print sum 10, 20

a b c &quot;a&quot;, &quot;b&quot;, &quot;c&quot;
</pre></div></div> <p>In order to avoid ambiguity in when calling functions, parentheses can also be used to surround the arguments. This is required here in order to make sure the right arguments get sent to the right functions.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token function">print</span> <span class="token string">&quot;x:&quot;</span><span class="token punctuation">,</span> sum<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;y:&quot;</span><span class="token punctuation">,</span> sum<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>print &quot;x:&quot;, sum(10, 20), &quot;y:&quot;, sum(30, 40)
</pre></div></div> <p>There must not be any space between the opening parenthesis and the function.</p> <p>Functions will coerce the last statement in their body into a return statement, this is called implicit return:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>sum <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">-&gt;</span> x <span class="token operator">+</span> y
<span class="token function">print</span> <span class="token string">&quot;The sum is &quot;</span><span class="token punctuation">,</span> sum <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>sum = (x, y) -&gt; x + y
print &quot;The sum is &quot;, sum 10, 20
</pre></div></div> <p>And if you need to explicitly return, you can use the return keyword:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>sum <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>sum = (x, y)-&gt; return x + y
</pre></div></div> <p>Just like in Lua, functions can return multiple values. The last statement must be a list of values separated by commas:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>mystery <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">-&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">,</span> x <span class="token operator">-</span> y
a<span class="token punctuation">,</span> b <span class="token operator">=</span> mystery <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>mystery = (x, y)-&gt; x + y, x - y
a, b = mystery 10, 20
</pre></div></div> <h3 id="fat-arrows"><a href="#fat-arrows" class="header-anchor">#</a> Fat Arrows</h3> <p>Because it is an idiom in Lua to send an object as the first argument when calling a method, a special syntax is provided for creating functions which automatically includes a self argument.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>func <span class="token operator">=</span> <span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token variable">@value</span> <span class="token operator">+</span> num
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>func = (num)=&gt; @value + num
</pre></div></div> <h3 id="argument-defaults"><a href="#argument-defaults" class="header-anchor">#</a> Argument Defaults</h3> <p>It is possible to provide default values for the arguments of a function. An argument is determined to be empty if its value is nil. Any nil arguments that have a default value will be replace before the body of the function is run.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>my_function <span class="token operator">=</span> <span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;something&quot;</span><span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>
  <span class="token function">print</span> <span class="token string">&quot;Hello I am&quot;</span><span class="token punctuation">,</span> name
  <span class="token function">print</span> <span class="token string">&quot;My height is&quot;</span><span class="token punctuation">,</span> height
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>my_function = (name = &quot;something&quot;, height = 100)-&gt;
  print &quot;Hello I am&quot;, name
  print &quot;My height is&quot;, height
</pre></div></div> <p>An argument default value expression is evaluated in the body of the function in the order of the argument declarations. For this reason default values have access to previously declared arguments.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>some_args <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> y <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>
  <span class="token function">print</span> x <span class="token operator">+</span> y
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>some_args = (x = 100, y = x + 1000)-&gt;
  print x + y
</pre></div></div> <h3 id="considerations"><a href="#considerations" class="header-anchor">#</a> Considerations</h3> <p>Because of the expressive parentheses-less way of calling functions, some restrictions must be put in place to avoid parsing ambiguity involving whitespace.</p> <p>The minus sign plays two roles, a unary negation operator and a binary subtraction operator. Consider how the following examples compile:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>a <span class="token operator">=</span> x <span class="token operator">-</span> <span class="token number">10</span>
b <span class="token operator">=</span> x<span class="token operator">-</span><span class="token number">10</span>
c <span class="token operator">=</span> x <span class="token operator">-</span>y
d <span class="token operator">=</span> x<span class="token operator">-</span> z
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>a = x - 10
b = x-10
c = x -y
d = x- z
</pre></div></div> <p>The precedence of the first argument of a function call can be controlled using whitespace if the argument is a literal string. In Lua, it is common to leave off parentheses when calling a function with a single string or table literal.</p> <p>When there is no space between a variable and a string literal, the function call takes precedence over any following expressions. No other arguments can be passed to the function when it is called this way.</p> <p>Where there is a space following a variable and a string literal, the function call acts as show above. The string literal belongs to any following expressions (if they exist), which serves as the argument list.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>x <span class="token operator">=</span> func<span class="token string">&quot;hello&quot;</span> <span class="token operator">+</span> <span class="token number">100</span>
y <span class="token operator">=</span> func <span class="token string">&quot;hello&quot;</span> <span class="token operator">+</span> <span class="token number">100</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>x = func&quot;hello&quot; + 100
y = func &quot;hello&quot; + 100
</pre></div></div> <h3 id="multi-line-arguments"><a href="#multi-line-arguments" class="header-anchor">#</a> Multi-line arguments</h3> <p>When calling functions that take a large number of arguments, it is convenient to split the argument list over multiple lines. Because of the white-space sensitive nature of the language, care must be taken when splitting up the argument list.</p> <p>If an argument list is to be continued onto the next line, the current line must end in a comma. And the following line must be indented more than the current indentation. Once indented, all other argument lines must be at the same level of indentation to be part of the argument list</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>my_func <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span>

cool_func <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
  <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>my_func 5, 4, 3,
  8, 9, 10

cool_func 1, 2,
  3, 4,
  5, 6,
  7, 8
</pre></div></div> <p>This type of invocation can be nested. The level of indentation is used to determine to which function the arguments belong to.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>my_func <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span>
  <span class="token number">6</span><span class="token punctuation">,</span> another_func <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>my_func 5, 6, 7,
  6, another_func 6, 7, 8,
    9, 1, 2,
  5, 4
</pre></div></div> <p>Because tables also use the comma as a delimiter, this indentation syntax is helpful for letting values be part of the argument list instead of being part of the table.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>x <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> a_func <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
  <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>x = {
  1, 2, 3, 4, a_func 4, 5,
    5, 6,
  8, 9, 10
}
</pre></div></div> <p>Although uncommon, notice how we can give a deeper indentation for function arguments if we know we will be using a lower indentation further on.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>y <span class="token operator">=</span> <span class="token punctuation">{</span> my_func <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
   <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span>
<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>y = { my_func 1, 2, 3,
   4, 5,
  5, 6, 7
}
</pre></div></div> <p>The same thing can be done with other block level statements like conditionals. We can use indentation level to determine what statement a value belongs to:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">if</span> func <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;world&quot;</span>
    <span class="token function">print</span> <span class="token string">&quot;hello&quot;</span>
    <span class="token function">print</span> <span class="token string">&quot;I am inside if&quot;</span>

<span class="token keyword">if</span> func <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;world&quot;</span>
  <span class="token function">print</span> <span class="token string">&quot;hello&quot;</span>
  <span class="token function">print</span> <span class="token string">&quot;I am inside if&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>if func 1, 2, 3,
  &quot;hello&quot;,
  &quot;world&quot;
    print &quot;hello&quot;
    print &quot;I am inside if&quot;

if func 1, 2, 3,
    &quot;hello&quot;,
    &quot;world&quot;
  print &quot;hello&quot;
  print &quot;I am inside if&quot;
</pre></div></div> <h2 id="table-literals"><a href="#table-literals" class="header-anchor">#</a> Table Literals</h2> <p>Like in Lua, tables are delimited in curly braces.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>some_values <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>some_values = { 1, 2, 3, 4 }
</pre></div></div> <p>Unlike Lua, assigning a value to a key in a table is done with <strong>:</strong> (instead of <strong>=</strong>).</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>some_values <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token property">name</span><span class="token operator">:</span> <span class="token string">&quot;Bill&quot;</span><span class="token punctuation">,</span>
  <span class="token property">age</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&quot;favorite food&quot;</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">&quot;rice&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>some_values = {
  name: &quot;Bill&quot;,
  age: 200,
  [&quot;favorite food&quot;]: &quot;rice&quot;
}
</pre></div></div> <p>The curly braces can be left off if a single table of key value pairs is being assigned.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>profile <span class="token operator">=</span>
  <span class="token property">height</span><span class="token operator">:</span> <span class="token string">&quot;4 feet&quot;</span><span class="token punctuation">,</span>
  <span class="token property">shoe_size</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
  <span class="token property">favorite_foods</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;ice cream&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;donuts&quot;</span><span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>profile =
  height: &quot;4 feet&quot;,
  shoe_size: 13,
  favorite_foods: {&quot;ice cream&quot;, &quot;donuts&quot;}
</pre></div></div> <p>Newlines can be used to delimit values instead of a comma (or both):</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>values <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span>
  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span>
  <span class="token property">name</span><span class="token operator">:</span> <span class="token string">&quot;superman&quot;</span>
  <span class="token property">occupation</span><span class="token operator">:</span> <span class="token string">&quot;crime fighting&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>values = {
  1, 2, 3, 4
  5, 6, 7, 8
  name: &quot;superman&quot;
  occupation: &quot;crime fighting&quot;
}
</pre></div></div> <p>When creating a single line table literal, the curly braces can also be left off:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>my_function <span class="token property">dance</span><span class="token operator">:</span> <span class="token string">&quot;Tango&quot;</span><span class="token punctuation">,</span> <span class="token property">partner</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span>

y <span class="token operator">=</span> <span class="token property">type</span><span class="token operator">:</span> <span class="token string">&quot;dog&quot;</span><span class="token punctuation">,</span> <span class="token property">legs</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token property">tails</span><span class="token operator">:</span> <span class="token number">1</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>my_function dance: &quot;Tango&quot;, partner: &quot;none&quot;

y = type: &quot;dog&quot;, legs: 4, tails: 1
</pre></div></div> <p>The keys of a table literal can be language keywords without being escaped:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>tbl <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">do</span><span class="token operator">:</span> <span class="token string">&quot;something&quot;</span>
  <span class="token property">end</span><span class="token operator">:</span> <span class="token string">&quot;hunger&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>tbl = {
  do: &quot;something&quot;
  end: &quot;hunger&quot;
}
</pre></div></div> <p>If you are constructing a table out of variables and wish the keys to be the same as the variable names, then the <strong>:</strong> prefix operator can be used:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>hair <span class="token operator">=</span> <span class="token string">&quot;golden&quot;</span>
height <span class="token operator">=</span> <span class="token number">200</span>
person <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">:</span><span class="token property">hair</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token property">height</span><span class="token punctuation">,</span> <span class="token property">shoe_size</span><span class="token operator">:</span> <span class="token number">40</span> <span class="token punctuation">}</span>

print_table <span class="token operator">:</span><span class="token property">hair</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token property">height</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>hair = &quot;golden&quot;
height = 200
person = { :hair, :height, shoe_size: 40 }

print_table :hair, :height
</pre></div></div> <p>If you want the key of a field in the table to to be result of an expression, then you can wrap it in <strong>[ ]</strong>, just like in Lua. You can also use a string literal directly as a key, leaving out the square brackets. This is useful if your key has any special characters.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>t <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span>
  <span class="token string">&quot;hello world&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>t = {
  [1 + 2]: &quot;hello&quot;
  &quot;hello world&quot;: true
}
</pre></div></div> <h2 id="comprehensions"><a href="#comprehensions" class="header-anchor">#</a> Comprehensions</h2> <p>Comprehensions provide a convenient syntax for constructing a new table by iterating over some existing object and applying an expression to its values. There are two kinds of comprehensions: list comprehensions and table comprehensions. They both produce Lua tables; list comprehensions accumulate values into an array-like table, and table comprehensions let you set both the key and the value on each iteration.</p> <h3 id="list-comprehensions"><a href="#list-comprehensions" class="header-anchor">#</a> List Comprehensions</h3> <p>The following creates a copy of the items table but with all the values doubled.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>items <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span>
doubled <span class="token operator">=</span> <span class="token punctuation">[</span>item <span class="token operator">*</span> <span class="token number">2</span> <span class="token keyword">for</span> i<span class="token punctuation">,</span> item <span class="token keyword">in</span> <span class="token function">ipairs</span> items<span class="token punctuation">]</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>items = { 1, 2, 3, 4 }
doubled = [item * 2 for i, item in ipairs items]
</pre></div></div> <p>The items included in the new table can be restricted with a when clause:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>iter <span class="token operator">=</span> <span class="token function">ipairs</span> items
slice <span class="token operator">=</span> <span class="token punctuation">[</span>item <span class="token keyword">for</span> i<span class="token punctuation">,</span> item <span class="token keyword">in</span> iter <span class="token keyword">when</span> i <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">and</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">]</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>iter = ipairs items
slice = [item for i, item in iter when i &gt; 1 and i &lt; 3]
</pre></div></div> <p>Because it is common to iterate over the values of a numerically indexed table, an <strong>*</strong> operator is introduced. The doubled example can be rewritten as:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>doubled <span class="token operator">=</span> <span class="token punctuation">[</span>item <span class="token operator">*</span> <span class="token number">2</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token operator">*</span>items<span class="token punctuation">]</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>doubled = [item * 2 for item in *items]
</pre></div></div> <p>The for and when clauses can be chained as much as desired. The only requirement is that a comprehension has at least one for clause.</p> <p>Using multiple for clauses is the same as using nested loops:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>x_coords <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span>
y_coords <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>

points <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>x<span class="token punctuation">,</span> y<span class="token punctuation">}</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token operator">*</span>x_coords <span class="token punctuation">\</span>
<span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token operator">*</span>y_coords<span class="token punctuation">]</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>x_coords = {4, 5, 6, 7}
y_coords = {9, 2, 3}

points = [{x, y} for x in *x_coords \
for y in *y_coords]
</pre></div></div> <p>Numeric for loops can also be used in comprehensions:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>evens <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token keyword">when</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>evens = [i for i = 1, 100 when i % 2 == 0]
</pre></div></div> <h3 id="table-comprehensions"><a href="#table-comprehensions" class="header-anchor">#</a> Table Comprehensions</h3> <p>The syntax for table comprehensions is very similar, only differing by using <strong>{</strong> and <strong>}</strong> and taking two values from each iteration.</p> <p>This example makes a copy of the tablething:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>thing <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span>
  <span class="token property">name</span><span class="token operator">:</span> <span class="token string">&quot;fast&quot;</span>
  <span class="token property">width</span><span class="token operator">:</span> <span class="token number">123</span>
<span class="token punctuation">}</span>

thing_copy <span class="token operator">=</span> <span class="token punctuation">{</span>k<span class="token punctuation">,</span> v <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span> thing<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>thing = {
  color: &quot;red&quot;
  name: &quot;fast&quot;
  width: 123
}

thing_copy = {k, v for k, v in pairs thing}
</pre></div></div> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>no_color <span class="token operator">=</span> <span class="token punctuation">{</span>k<span class="token punctuation">,</span> v <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span> thing <span class="token keyword">when</span> k <span class="token operator">!=</span> <span class="token string">&quot;color&quot;</span><span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>no_color = {k, v for k, v in pairs thing when k != &quot;color&quot;}
</pre></div></div> <p>The <strong>*</strong> operator is also supported. Here we create a square root look up table for a few numbers.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span>
sqrts <span class="token operator">=</span> <span class="token punctuation">{</span>i<span class="token punctuation">,</span> <span class="token function">math<span class="token punctuation">.</span>sqrt</span> i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token operator">*</span>numbers<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>numbers = {1, 2, 3, 4}
sqrts = {i, math.sqrt i for i in *numbers}
</pre></div></div> <p>The key-value tuple in a table comprehension can also come from a single expression, in which case the expression should return two values. The first is used as the key and the second is used as the value:</p> <p>In this example we convert an array of pairs to a table where the first item in the pair is the key and the second is the value.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>tuples <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
tbl <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token function">unpack</span> tuple <span class="token keyword">for</span> tuple <span class="token keyword">in</span> <span class="token operator">*</span>tuples<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>tuples = { {&quot;hello&quot;, &quot;world&quot;}, {&quot;foo&quot;, &quot;bar&quot;} }
tbl = {unpack tuple for tuple in *tuples}
</pre></div></div> <h3 id="slicing"><a href="#slicing" class="header-anchor">#</a> Slicing</h3> <p>A special syntax is provided to restrict the items that are iterated over when using the <strong>*</strong> operator. This is equivalent to setting the iteration bounds and a step size in a for loop.</p> <p>Here we can set the minimum and maximum bounds, taking all items with indexes between 1 and 5 inclusive:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>slice <span class="token operator">=</span> <span class="token punctuation">[</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token operator">*</span>items<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>slice = [item for item in *items[1, 5]]
</pre></div></div> <p>Any of the slice arguments can be left off to use a sensible default. In this example, if the max index is left off it defaults to the length of the table. This will take everything but the first element:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>slice <span class="token operator">=</span> <span class="token punctuation">[</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token operator">*</span>items<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>slice = [item for item in *items[2,]]
</pre></div></div> <p>If the minimum bound is left out, it defaults to 1. Here we only provide a step size and leave the other bounds blank. This takes all odd indexed items: (1, 3, 5, …)</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>slice <span class="token operator">=</span> <span class="token punctuation">[</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token operator">*</span>items<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>slice = [item for item in *items[,,2]]
</pre></div></div> <h2 id="for-loop"><a href="#for-loop" class="header-anchor">#</a> For Loop</h2> <p>There are two for loop forms, just like in Lua. A numeric one and a generic one:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span>
  <span class="token function">print</span> i

<span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token comment">-- an optional step provided</span>
  <span class="token function">print</span> k

<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token function">pairs</span> object
  <span class="token function">print</span> key<span class="token punctuation">,</span> value
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>for i = 10, 20
  print i

for k = 1, 15, 2 -- an optional step provided
  print k

for key, value in pairs object
  print key, value
</pre></div></div> <p>The slicing and <strong>*</strong> operators can be used, just like with comprehensions:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token operator">*</span>items<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
  <span class="token function">print</span> item
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>for item in *items[2, 4]
  print item
</pre></div></div> <p>A shorter syntax is also available for all variations when the body is only a single line:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token operator">*</span>items <span class="token keyword">do</span> <span class="token function">print</span> item

<span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token keyword">do</span> <span class="token function">print</span> j
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>for item in *items do print item

for j = 1, 10, 3 do print j
</pre></div></div> <p>A for loop can also be used as an expression. The last statement in the body of the for loop is coerced into an expression and appended to an accumulating array table.</p> <p>Doubling every even number:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>doubled_evens <span class="token operator">=</span> <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span>
  <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span>
    i <span class="token operator">*</span> <span class="token number">2</span>
  <span class="token keyword">else</span>
    i
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>doubled_evens = for i = 1, 20
  if i % 2 == 0
    i * 2
  else
    i
</pre></div></div> <p>You can also filter values by combining the for loop expression with the continue statement.</p> <p>For loops at the end of a function body are not accumulated into a table for a return value (Instead the function will return nil). Either an explicit return statement can be used, or the loop can be converted into a list comprehension.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>func_a <span class="token operator">=</span> <span class="token operator">-&gt;</span> <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token keyword">do</span> <span class="token function">print</span> i
func_b <span class="token operator">=</span> <span class="token operator">-&gt;</span> <span class="token keyword">return</span> <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token keyword">do</span> i

<span class="token function">print</span> func_a<span class="token operator">!</span> <span class="token comment">-- prints nil</span>
<span class="token function">print</span> func_b<span class="token operator">!</span> <span class="token comment">-- prints table object</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>func_a = -&gt; for i = 1, 10 do print i
func_b = -&gt; return for i = 1, 10 do i

print func_a! -- prints nil
print func_b! -- prints table object
</pre></div></div> <p>This is done to avoid the needless creation of tables for functions that don’t need to return the results of the loop.</p> <h2 id="while-loop"><a href="#while-loop" class="header-anchor">#</a> While Loop</h2> <p>The while loop also comes in two variations:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>i <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">while</span> i <span class="token operator">&gt;</span> <span class="token number">0</span>
  <span class="token function">print</span> i
  i <span class="token operator">-=</span> <span class="token number">1</span>

<span class="token keyword">while</span> running <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token keyword">do</span> my_function<span class="token operator">!</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>i = 10
while i &gt; 0
  print i
  i -= 1

while running == true do my_function!
</pre></div></div> <p>Like for loops, the while loop can also be used an expression. Additionally, for a function to return the accumulated value of a while loop, the statement must be explicitly returned.</p> <h2 id="continue"><a href="#continue" class="header-anchor">#</a> Continue</h2> <p>A continue statement can be used to skip the current iteration in a loop.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token number">10</span>
  i <span class="token operator">+=</span> <span class="token number">1</span>
  <span class="token keyword">continue</span> <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span>
  <span class="token function">print</span> i
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>i = 0
while i &lt; 10
  i += 1
  continue if i % 2 == 0
  print i
</pre></div></div> <p>continue can also be used with loop expressions to prevent that iteration from accumulating into the result. This examples filters the array table into just even numbers:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>my_numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span>
odds <span class="token operator">=</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token operator">*</span>my_numbers
  <span class="token keyword">continue</span> <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span>
  x
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>my_numbers = {1, 2, 3, 4, 5, 6}
odds = for x in *my_numbers
  continue if x % 2 == 1
  x
</pre></div></div> <h2 id="conditionals"><a href="#conditionals" class="header-anchor">#</a> Conditionals</h2> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>have_coins <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">if</span> have_coins
  <span class="token function">print</span> <span class="token string">&quot;Got coins&quot;</span>
<span class="token keyword">else</span>
  <span class="token function">print</span> <span class="token string">&quot;No coins&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>have_coins = false
if have_coins
  print &quot;Got coins&quot;
else
  print &quot;No coins&quot;
</pre></div></div> <p>A short syntax for single statements can also be used:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>have_coins <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">if</span> have_coins <span class="token keyword">then</span> <span class="token function">print</span> <span class="token string">&quot;Got coins&quot;</span> <span class="token keyword">else</span> <span class="token function">print</span> <span class="token string">&quot;No coins&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>have_coins = false
if have_coins then print &quot;Got coins&quot; else print &quot;No coins&quot;
</pre></div></div> <p>Because if statements can be used as expressions, this can also be written as:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>have_coins <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token function">print</span> <span class="token keyword">if</span> have_coins <span class="token keyword">then</span> <span class="token string">&quot;Got coins&quot;</span> <span class="token keyword">else</span> <span class="token string">&quot;No coins&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>have_coins = false
print if have_coins then &quot;Got coins&quot; else &quot;No coins&quot;
</pre></div></div> <p>Conditionals can also be used in return statements and assignments:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>is_tall <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
  <span class="token keyword">if</span> name <span class="token operator">==</span> <span class="token string">&quot;Rob&quot;</span>
    <span class="token boolean">true</span>
  <span class="token keyword">else</span>
    <span class="token boolean">false</span>

message <span class="token operator">=</span> <span class="token keyword">if</span> is_tall <span class="token string">&quot;Rob&quot;</span>
  <span class="token string">&quot;I am very tall&quot;</span>
<span class="token keyword">else</span>
  <span class="token string">&quot;I am not so tall&quot;</span>

<span class="token function">print</span> message <span class="token comment">-- prints: I am very tall</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>is_tall = (name) -&gt;
  if name == &quot;Rob&quot;
    true
  else
    false

message = if is_tall &quot;Rob&quot;
  &quot;I am very tall&quot;
else
  &quot;I am not so tall&quot;

print message -- prints: I am very tall
</pre></div></div> <p>The opposite of if is unless:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">unless</span> <span class="token function">os<span class="token punctuation">.</span>date</span><span class="token punctuation">(</span><span class="token string">&quot;%A&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;Monday&quot;</span>
  <span class="token function">print</span> <span class="token string">&quot;it is not Monday!&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>unless os.date(&quot;%A&quot;) == &quot;Monday&quot;
  print &quot;it is not Monday!&quot;
</pre></div></div> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token function">print</span> <span class="token string">&quot;You're lucky!&quot;</span> <span class="token keyword">unless</span> <span class="token function">math<span class="token punctuation">.</span>random</span><span class="token operator">!</span> <span class="token operator">&gt;</span> <span class="token number">0.1</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>print &quot;You're lucky!&quot; unless math.random! &gt; 0.1
</pre></div></div> <h2 id="if-assignment"><a href="#if-assignment" class="header-anchor">#</a> If Assignment</h2> <p>if and elseif blocks can take an assignment in place of a conditional expression. Upon evaluating the conditional, the assignment will take place and the value that was assigned to will be used as the conditional expression. The assigned variable is only in scope for the body of the conditional, meaning it is never available if the value is not truthy.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">if</span> user <span class="token operator">=</span> database<span class="token punctuation">.</span>find_user <span class="token string">&quot;moon&quot;</span>
  <span class="token function">print</span> user<span class="token punctuation">.</span>name
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>if user = database.find_user &quot;moon&quot;
  print user.name
</pre></div></div> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">if</span> hello <span class="token operator">=</span> <span class="token function">os<span class="token punctuation">.</span>getenv</span> <span class="token string">&quot;hello&quot;</span>
  <span class="token function">print</span> <span class="token string">&quot;You have hello&quot;</span><span class="token punctuation">,</span> hello
<span class="token keyword">elseif</span> world <span class="token operator">=</span> <span class="token function">os<span class="token punctuation">.</span>getenv</span> <span class="token string">&quot;world&quot;</span>
  <span class="token function">print</span> <span class="token string">&quot;you have world&quot;</span><span class="token punctuation">,</span> world
<span class="token keyword">else</span>
  <span class="token function">print</span> <span class="token string">&quot;nothing :(&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>if hello = os.getenv &quot;hello&quot;
  print &quot;You have hello&quot;, hello
elseif world = os.getenv &quot;world&quot;
  print &quot;you have world&quot;, world
else
  print &quot;nothing :(&quot;
</pre></div></div> <h2 id="line-decorators"><a href="#line-decorators" class="header-anchor">#</a> Line Decorators</h2> <p>For convenience, the for loop and if statement can be applied to single statements at the end of the line:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token function">print</span> <span class="token string">&quot;hello world&quot;</span> <span class="token keyword">if</span> name <span class="token operator">==</span> <span class="token string">&quot;Rob&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>print &quot;hello world&quot; if name == &quot;Rob&quot;
</pre></div></div> <p>And with basic loops:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token function">print</span> <span class="token string">&quot;item: &quot;</span><span class="token punctuation">,</span> item <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token operator">*</span>items
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>print &quot;item: &quot;, item for item in *items
</pre></div></div> <h2 id="switch"><a href="#switch" class="header-anchor">#</a> Switch</h2> <p>The switch statement is shorthand for writing a series of if statements that check against the same value. Note that the value is only evaluated once. Like if statements, switches can have an else block to handle no matches. Comparison is done with the == operator.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>name <span class="token operator">=</span> <span class="token string">&quot;Dan&quot;</span>
<span class="token keyword">switch</span> name
  <span class="token keyword">when</span> <span class="token string">&quot;Robert&quot;</span>
    <span class="token function">print</span> <span class="token string">&quot;You are Robert&quot;</span>
  <span class="token keyword">when</span> <span class="token string">&quot;Dan&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Daniel&quot;</span>
    <span class="token function">print</span> <span class="token string">&quot;Your name, it's Dan&quot;</span>
  <span class="token keyword">else</span>
    <span class="token function">print</span> <span class="token string">&quot;I don't know about your name&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>name = &quot;Dan&quot;
switch name
  when &quot;Robert&quot;
    print &quot;You are Robert&quot;
  when &quot;Dan&quot;, &quot;Daniel&quot;
    print &quot;Your name, it's Dan&quot;
  else
    print &quot;I don't know about your name&quot;
</pre></div></div> <p>A switch when clause can match against multiple values by listing them out comma separated.</p> <p>Switches can be used as expressions as well, here we can assign the result of the switch to a variable:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>b <span class="token operator">=</span> <span class="token number">1</span>
next_number <span class="token operator">=</span> <span class="token keyword">switch</span> b
  <span class="token keyword">when</span> <span class="token number">1</span>
    <span class="token number">2</span>
  <span class="token keyword">when</span> <span class="token number">2</span>
    <span class="token number">3</span>
  <span class="token keyword">else</span>
    <span class="token function">error</span> <span class="token string">&quot;can't count that high!&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>b = 1
next_number = switch b
  when 1
    2
  when 2
    3
  else
    error &quot;can't count that high!&quot;
</pre></div></div> <p>We can use the then keyword to write a switch’s when block on a single line. No extra keyword is needed to write the else block on a single line.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>msg <span class="token operator">=</span> <span class="token keyword">switch</span> <span class="token function">math<span class="token punctuation">.</span>random</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token keyword">when</span> <span class="token number">1</span> <span class="token keyword">then</span> <span class="token string">&quot;you are lucky&quot;</span>
  <span class="token keyword">when</span> <span class="token number">2</span> <span class="token keyword">then</span> <span class="token string">&quot;you are almost lucky&quot;</span>
  <span class="token keyword">else</span> <span class="token string">&quot;not so lucky&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>msg = switch math.random(1, 5)
  when 1 then &quot;you are lucky&quot;
  when 2 then &quot;you are almost lucky&quot;
  else &quot;not so lucky&quot;
</pre></div></div> <p>It is worth noting the order of the case comparison expression. The case’s expression is on the left hand side. This can be useful if the case’s expression wants to overwrite how the comparison is done by defining an eq metamethod.</p> <h2 id="object-oriented-programming"><a href="#object-oriented-programming" class="header-anchor">#</a> Object Oriented Programming</h2> <p>In these examples, the generated Lua code may appear overwhelming. It is best to focus on the meaning of the Yuescript code at first, then look into the Lua code if you wish to know the implementation details.</p> <p>A simple class:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">Inventory</span>
  <span class="token property">new</span><span class="token operator">:</span> <span class="token operator">=&gt;</span>
    <span class="token variable">@items</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token property">add_item</span><span class="token operator">:</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token operator">=&gt;</span>
    <span class="token keyword">if</span> <span class="token variable">@items</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span>
      <span class="token variable">@items</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">else</span>
      <span class="token variable">@items</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class Inventory
  new: =&gt;
    @items = {}

  add_item: (name)=&gt;
    if @items[name]
      @items[name] += 1
    else
      @items[name] = 1
</pre></div></div> <p>A class is declared with a class statement followed by a table-like declaration where all of the methods and properties are listed.</p> <p>The new property is special in that it will become the constructor.</p> <p>Notice how all the methods in the class use the fat arrow function syntax. When calling methods on a instance, the instance itself is sent in as the first argument. The fat arrow handles the creation of a self argument.</p> <p>The @ prefix on a variable name is shorthand for self.. @items becomes self.items.</p> <p>Creating an instance of the class is done by calling the name of the class as a function.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>inv <span class="token operator">=</span> <span class="token class-name">Inventory</span><span class="token operator">!</span>
inv<span class="token punctuation">\</span>add_item <span class="token string">&quot;t-shirt&quot;</span>
inv<span class="token punctuation">\</span>add_item <span class="token string">&quot;pants&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>inv = Inventory!
inv\add_item &quot;t-shirt&quot;
inv\add_item &quot;pants&quot;
</pre></div></div> <p>Because the instance of the class needs to be sent to the methods when they are called, the \ operator is used.</p> <p>All properties of a class are shared among the instances. This is fine for functions, but for other types of objects, undesired results may occur.</p> <p>Consider the example below, the clothes property is shared amongst all instances, so modifications to it in one instance will show up in another:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
  <span class="token property">clothes</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token property">give_item</span><span class="token operator">:</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token operator">=&gt;</span>
    <span class="token function">table<span class="token punctuation">.</span>insert</span> <span class="token variable">@clothes</span><span class="token punctuation">,</span> name

a <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token operator">!</span>
b <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token operator">!</span>

a<span class="token punctuation">\</span>give_item <span class="token string">&quot;pants&quot;</span>
b<span class="token punctuation">\</span>give_item <span class="token string">&quot;shirt&quot;</span>

<span class="token comment">-- will print both pants and shirt</span>
<span class="token function">print</span> item <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token operator">*</span>a<span class="token punctuation">.</span>clothes
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class Person
  clothes: {}
  give_item: (name)=&gt;
    table.insert @clothes, name

a = Person!
b = Person!

a\give_item &quot;pants&quot;
b\give_item &quot;shirt&quot;

-- will print both pants and shirt
print item for item in *a.clothes
</pre></div></div> <p>The proper way to avoid this problem is to create the mutable state of the object in the constructor:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">Person</span>
  <span class="token property">new</span><span class="token operator">:</span> <span class="token operator">=&gt;</span>
    <span class="token variable">@clothes</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class Person
  new: =&gt;
    @clothes = {}
</pre></div></div> <h3 id="inheritance"><a href="#inheritance" class="header-anchor">#</a> Inheritance</h3> <p>The extends keyword can be used in a class declaration to inherit the properties and methods from another class.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">BackPack</span> <span class="token keyword">extends</span> <span class="token class-name">Inventory</span>
  <span class="token property">size</span><span class="token operator">:</span> <span class="token number">10</span>
  <span class="token property">add_item</span><span class="token operator">:</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token operator">=&gt;</span>
    <span class="token keyword">if</span> <span class="token operator">#</span><span class="token variable">@items</span> <span class="token operator">&gt;</span> size <span class="token keyword">then</span> <span class="token function">error</span> <span class="token string">&quot;backpack is full&quot;</span>
    <span class="token keyword">super</span> name
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class BackPack extends Inventory
  size: 10
  add_item: (name)=&gt;
    if #@items &gt; size then error &quot;backpack is full&quot;
    super name
</pre></div></div> <p>Here we extend our Inventory class, and limit the amount of items it can carry.</p> <p>In this example, we don’t define a constructor on the subclass, so the parent class' constructor is called when we make a new instance. If we did define a constructor then we can use the super method to call the parent constructor.</p> <p>Whenever a class inherits from another, it sends a message to the parent class by calling the method __inherited on the parent class if it exists. The function receives two arguments, the class that is being inherited and the child class.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">Shelf</span>
  <span class="token variable">@__inherited</span><span class="token operator">:</span> <span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token operator">=&gt;</span>
    <span class="token function">print</span> <span class="token variable">@__name</span><span class="token punctuation">,</span> <span class="token string">&quot;was inherited by&quot;</span><span class="token punctuation">,</span> child<span class="token punctuation">.</span>__name

<span class="token comment">-- will print: Shelf was inherited by Cupboard</span>
<span class="token keyword">class</span> <span class="token class-name">Cupboard</span> <span class="token keyword">extends</span> <span class="token class-name">Shelf</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class Shelf
  @__inherited: (child)=&gt;
    print @__name, &quot;was inherited by&quot;, child.__name

-- will print: Shelf was inherited by Cupboard
class Cupboard extends Shelf
</pre></div></div> <h3 id="super"><a href="#super" class="header-anchor">#</a> Super</h3> <p><strong>super</strong> is a special keyword that can be used in two different ways: It can be treated as an object, or it can be called like a function. It only has special functionality when inside a class.</p> <p>When called as a function, it will call the function of the same name in the parent class. The current self will automatically be passed as the first argument. (As seen in the inheritance example above)</p> <p>When super is used as a normal value, it is a reference to the parent class object.</p> <p>It can be accessed like any of object in order to retrieve values in the parent class that might have been shadowed by the child class.</p> <p>When the \ calling operator is used with super, self is inserted as the first argument instead of the value of super itself. When using . to retrieve a function, the raw function is returned.</p> <p>A few examples of using super in different ways:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token keyword">extends</span> <span class="token class-name">ParentClass</span>
  <span class="token property">a_method</span><span class="token operator">:</span> <span class="token operator">=&gt;</span>
    <span class="token comment">-- the following have the same effect:</span>
    <span class="token keyword">super</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world&quot;</span>
    <span class="token keyword">super</span><span class="token punctuation">\</span>a_method <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world&quot;</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span>a_method <span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world&quot;</span>

    <span class="token comment">-- super as a value is equal to the parent class:</span>
    <span class="token function">assert</span> <span class="token keyword">super</span> <span class="token operator">==</span> <span class="token class-name">ParentClass</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class MyClass extends ParentClass
  a_method: =&gt;
    -- the following have the same effect:
    super &quot;hello&quot;, &quot;world&quot;
    super\a_method &quot;hello&quot;, &quot;world&quot;
    super.a_method self, &quot;hello&quot;, &quot;world&quot;

    -- super as a value is equal to the parent class:
    assert super == ParentClass
</pre></div></div> <p><strong>super</strong> can also be used on left side of a Function Stub. The only major difference is that instead of the resulting function being bound to the value of super, it is bound to self.</p> <h3 id="types"><a href="#types" class="header-anchor">#</a> Types</h3> <p>Every instance of a class carries its type with it. This is stored in the special __class property. This property holds the class object. The class object is what we call to build a new instance. We can also index the class object to retrieve class methods and properties.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>b <span class="token operator">=</span> <span class="token class-name">BackPack</span><span class="token operator">!</span>
<span class="token function">assert</span> b<span class="token punctuation">.</span>__class <span class="token operator">==</span> <span class="token class-name">BackPack</span>

<span class="token function">print</span> <span class="token class-name">BackPack</span><span class="token punctuation">.</span>size <span class="token comment">-- prints 10</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>b = BackPack!
assert b.__class == BackPack

print BackPack.size -- prints 10
</pre></div></div> <h3 id="class-objects"><a href="#class-objects" class="header-anchor">#</a> Class Objects</h3> <p>The class object is what we create when we use a class statement. The class object is stored in a variable of the same name of the class.</p> <p>The class object can be called like a function in order to create new instances. That’s how we created instances of classes in the examples above.</p> <p>A class is made up of two tables. The class table itself, and the base table. The base is used as the metatable for all the instances. All properties listed in the class declaration are placed in the base.</p> <p>The class object’s metatable reads properties from the base if they don’t exist in the class object. This means we can access functions and properties directly from the class.</p> <p>It is important to note that assigning to the class object does not assign into the base, so it’s not a valid way to add new methods to instances. Instead the base must explicitly be changed. See the __base field below.</p> <p>The class object has a couple special properties:</p> <p>The name of the class as when it was declared is stored as a string in the __name field of the class object.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token function">print</span> <span class="token class-name">BackPack</span><span class="token punctuation">.</span>__name <span class="token comment">-- prints Backpack</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>print BackPack.__name -- prints Backpack
</pre></div></div> <p>The base object is stored in __base. We can modify this table to add functionality to instances that have already been created and ones that are yet to be created.</p> <p>If the class extends from anything, the parent class object is stored in __parent.</p> <h3 id="class-variables"><a href="#class-variables" class="header-anchor">#</a> Class Variables</h3> <p>We can create variables directly in the class object instead of in the base by using @ in the front of the property name in a class declaration.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">Things</span>
  <span class="token variable">@some_func</span><span class="token operator">:</span> <span class="token operator">=&gt;</span> <span class="token function">print</span> <span class="token string">&quot;Hello from&quot;</span><span class="token punctuation">,</span> <span class="token variable">@__name</span>

<span class="token class-name">Things</span><span class="token punctuation">\</span>some_func<span class="token operator">!</span>

<span class="token comment">-- class variables not visible in instances</span>
<span class="token function">assert</span> <span class="token class-name">Things</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>some_func <span class="token operator">==</span> <span class="token keyword">nil</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class Things
  @some_func: =&gt; print &quot;Hello from&quot;, @__name

Things\some_func!

-- class variables not visible in instances
assert Things().some_func == nil
</pre></div></div> <p>In expressions, we can use @@ to access a value that is stored in the __class of self. Thus, @@hello is shorthand for self.__class.hello.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">Counter</span>
  <span class="token variable">@count</span><span class="token operator">:</span> <span class="token number">0</span>

  <span class="token property">new</span><span class="token operator">:</span> <span class="token operator">=&gt;</span>
    <span class="token variable">@@count</span> <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token class-name">Counter</span><span class="token operator">!</span>
<span class="token class-name">Counter</span><span class="token operator">!</span>

<span class="token function">print</span> <span class="token class-name">Counter</span><span class="token punctuation">.</span>count <span class="token comment">-- prints 2</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class Counter
  @count: 0

  new: =&gt;
    @@count += 1

Counter!
Counter!

print Counter.count -- prints 2
</pre></div></div> <p>The calling semantics of @@ are similar to @. Calling a @@ name will pass the class in as the first argument using Lua’s colon syntax.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token variable">@@hello</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>@@hello 1,2,3,4
</pre></div></div> <h3 id="class-declaration-statements"><a href="#class-declaration-statements" class="header-anchor">#</a> Class Declaration Statements</h3> <p>In the body of a class declaration, we can have normal expressions in addition to key/value pairs. In this context, self is equal to the class object.</p> <p>Here is an alternative way to create a class variable compared to what’s described above:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">Things</span>
  <span class="token variable">@class_var</span> <span class="token operator">=</span> <span class="token string">&quot;hello world&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class Things
  @class_var = &quot;hello world&quot;
</pre></div></div> <p>These expressions are executed after all the properties have been added to the base.</p> <p>All variables declared in the body of the class are local to the classes properties. This is convenient for placing private values or helper functions that only the class methods can access:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">class</span> <span class="token class-name">MoreThings</span>
  secret <span class="token operator">=</span> <span class="token number">123</span>
  log <span class="token operator">=</span> <span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token function">print</span> <span class="token string">&quot;LOG:&quot;</span><span class="token punctuation">,</span> msg

  <span class="token property">some_method</span><span class="token operator">:</span> <span class="token operator">=&gt;</span>
    log <span class="token string">&quot;hello world: &quot;</span> <span class="token operator">..</span> secret
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>class MoreThings
  secret = 123
  log = (msg)-&gt; print &quot;LOG:&quot;, msg

  some_method: =&gt;
    log &quot;hello world: &quot; .. secret
</pre></div></div> <h3 id="and-values"><a href="#and-values" class="header-anchor">#</a> @ and @@ Values</h3> <p>When @ and @@ are prefixed in front of a name they represent, respectively, that name accessed in self and self.__class.</p> <p>If they are used all by themselves, they are aliases for self and self.__class.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token function">assert</span> <span class="token variable">@</span> <span class="token operator">==</span> <span class="token keyword">self</span>
<span class="token function">assert</span> <span class="token variable">@@</span> <span class="token operator">==</span> <span class="token keyword">self</span><span class="token punctuation">.</span>__class
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>assert @ == self
assert @@ == self.__class
</pre></div></div> <p>For example, a quick way to create a new instance of the same class from an instance method using @@:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>some_instance_method <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token variable">@@</span> <span class="token operator">...</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>some_instance_method = (...)=&gt; @@ ...
</pre></div></div> <h3 id="class-expressions"><a href="#class-expressions" class="header-anchor">#</a> Class Expressions</h3> <p>The class syntax can also be used as an expression which can be assigned to a variable or explicitly returned.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>x <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">Bucket</span>
  <span class="token property">drops</span><span class="token operator">:</span> <span class="token number">0</span>
  <span class="token property">add_drop</span><span class="token operator">:</span> <span class="token operator">=&gt;</span> <span class="token variable">@drops</span> <span class="token operator">+=</span> <span class="token number">1</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>x = class Bucket
  drops: 0
  add_drop: =&gt; @drops += 1
</pre></div></div> <h3 id="anonymous-classes"><a href="#anonymous-classes" class="header-anchor">#</a> Anonymous classes</h3> <p>The name can be left out when declaring a class. The __name attribute will be nil, unless the class expression is in an assignment. The name on the left hand side of the assignment is used instead of nil.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token class-name">BigBucket</span> <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> <span class="token class-name">Bucket</span>
  <span class="token property">add_drop</span><span class="token operator">:</span> <span class="token operator">=&gt;</span> <span class="token variable">@drops</span> <span class="token operator">+=</span> <span class="token number">10</span>

<span class="token function">assert</span> <span class="token class-name">Bucket</span><span class="token punctuation">.</span>__name <span class="token operator">==</span> <span class="token string">&quot;BigBucket&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>BigBucket = class extends Bucket
  add_drop: =&gt; @drops += 10

assert Bucket.__name == &quot;BigBucket&quot;
</pre></div></div> <p>You can even leave off the body, meaning you can write a blank anonymous class like this:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>x <span class="token operator">=</span> <span class="token keyword">class</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>x = class
</pre></div></div> <h2 id="with-statement"><a href="#with-statement" class="header-anchor">#</a> With Statement</h2> <p>A common pattern involving the creation of an object is calling a series of functions and setting a series of properties immediately after creating it.</p> <p>This results in repeating the name of the object multiple times in code, adding unnecessary noise. A common solution to this is to pass a table in as an argument which contains a collection of keys and values to overwrite. The downside to this is that the constructor of this object must support this form.</p> <p>The with block helps to alleviate this. Within a with block we can use a special statements that begin with either . or \ which represent those operations applied to the object we are using with on.</p> <p>For example, we work with a newly created object:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">with</span> <span class="token class-name">Person</span><span class="token operator">!</span>
  <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Oswald&quot;</span>
  <span class="token punctuation">\</span>add_relative my_dad
  <span class="token punctuation">\</span>save<span class="token operator">!</span>
  <span class="token function">print</span> <span class="token punctuation">.</span>name
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>with Person!
  .name = &quot;Oswald&quot;
  \add_relative my_dad
  \save!
  print .name
</pre></div></div> <p>The with statement can also be used as an expression which returns the value it has been giving access to.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>file <span class="token operator">=</span> <span class="token keyword">with</span> <span class="token class-name">File</span> <span class="token string">&quot;favorite_foods.txt&quot;</span>
  <span class="token punctuation">\</span>set_encoding <span class="token string">&quot;utf8&quot;</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>file = with File &quot;favorite_foods.txt&quot;
  \set_encoding &quot;utf8&quot;
</pre></div></div> <p>Or…</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>create_person <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>  relatives<span class="token punctuation">)</span><span class="token operator">-&gt;</span>
  <span class="token keyword">with</span> <span class="token class-name">Person</span><span class="token operator">!</span>
    <span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token punctuation">\</span>add_relative relative <span class="token keyword">for</span> relative <span class="token keyword">in</span> <span class="token operator">*</span>relatives

me <span class="token operator">=</span> create_person <span class="token string">&quot;Leaf&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>dad<span class="token punctuation">,</span> mother<span class="token punctuation">,</span> sister<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>create_person = (name,  relatives)-&gt;
  with Person!
    .name = name
    \add_relative relative for relative in *relatives

me = create_person &quot;Leaf&quot;, {dad, mother, sister}
</pre></div></div> <p>In this usage, with can be seen as a special form of the K combinator.</p> <p>The expression in the with statement can also be an assignment, if you want to give a name to the expression.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">with</span> str <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span>
  <span class="token function">print</span> <span class="token string">&quot;original:&quot;</span><span class="token punctuation">,</span> str
  <span class="token function">print</span> <span class="token string">&quot;upper:&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">\</span>upper<span class="token operator">!</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>with str = &quot;Hello&quot;
  print &quot;original:&quot;, str
  print &quot;upper:&quot;, \upper!
</pre></div></div> <h2 id="do"><a href="#do" class="header-anchor">#</a> Do</h2> <p>When used as a statement, do works just like it does in Lua.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token keyword">do</span>
  var <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span>
  <span class="token function">print</span> var
<span class="token function">print</span> var <span class="token comment">-- nil here</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>do
  var = &quot;hello&quot;
  print var
print var -- nil here
</pre></div></div> <p>Yuescript’s <strong>do</strong> can also be used an expression . Allowing you to combine multiple lines into one. The result of the do expression is the last statement in its body.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>counter <span class="token operator">=</span> <span class="token keyword">do</span>
  i <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token operator">-&gt;</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>
    i

<span class="token function">print</span> counter<span class="token operator">!</span>
<span class="token function">print</span> counter<span class="token operator">!</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>counter = do
  i = 0
  -&gt;
    i += 1
    i

print counter!
print counter!
</pre></div></div> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>tbl <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token property">key</span><span class="token operator">:</span> <span class="token keyword">do</span>
    <span class="token function">print</span> <span class="token string">&quot;assigning key!&quot;</span>
    <span class="token number">1234</span>
<span class="token punctuation">}</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>tbl = {
  key: do
    print &quot;assigning key!&quot;
    1234
}
</pre></div></div> <h2 id="destructuring-assignment"><a href="#destructuring-assignment" class="header-anchor">#</a> Destructuring Assignment</h2> <p>Destructuring assignment is a way to quickly extract values from a table by their name or position in array based tables.</p> <p>Typically when you see a table literal, {1,2,3}, it is on the right hand side of an assignment because it is a value. Destructuring assignment swaps the role of the table literal, and puts it on the left hand side of an assign statement.</p> <p>This is best explained with examples. Here is how you would unpack the first two values from a table:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>thing <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span>a<span class="token punctuation">,</span> b<span class="token punctuation">}</span> <span class="token operator">=</span> thing
<span class="token function">print</span> a<span class="token punctuation">,</span> b
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>thing = {1, 2}

{a, b} = thing
print a, b
</pre></div></div> <p>In the destructuring table literal, the key represents the key to read from the right hand side, and the value represents the name the read value will be assigned to.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token property">hello</span><span class="token operator">:</span> <span class="token string">&quot;world&quot;</span>
  <span class="token property">day</span><span class="token operator">:</span> <span class="token string">&quot;tuesday&quot;</span>
  <span class="token property">length</span><span class="token operator">:</span> <span class="token number">20</span>
<span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token property">hello</span><span class="token operator">:</span> hello<span class="token punctuation">,</span> <span class="token property">day</span><span class="token operator">:</span> the_day<span class="token punctuation">}</span> <span class="token operator">=</span> obj
<span class="token function">print</span> hello<span class="token punctuation">,</span> the_day
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>obj = {
  hello: &quot;world&quot;
  day: &quot;tuesday&quot;
  length: 20
}

{hello: hello, day: the_day} = obj
print hello, the_day
</pre></div></div> <p>This also works with nested data structures as well:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token property">numbers</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span>
  <span class="token property">properties</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token operator">:</span> <span class="token string">&quot;green&quot;</span>
    <span class="token property">height</span><span class="token operator">:</span> <span class="token number">13.5</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token property">numbers</span><span class="token operator">:</span> <span class="token punctuation">{</span>first<span class="token punctuation">,</span> second<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">=</span> obj2
<span class="token function">print</span> first<span class="token punctuation">,</span> second<span class="token punctuation">,</span> color
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>obj2 = {
  numbers: {1,2,3,4}
  properties: {
    color: &quot;green&quot;
    height: 13.5
  }
}

{numbers: {first, second}} = obj2
print first, second, color
</pre></div></div> <p>If the destructuring statement is complicated, feel free to spread it out over a few lines. A slightly more complicated example:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token punctuation">{</span>
  <span class="token property">numbers</span><span class="token operator">:</span> <span class="token punctuation">{</span>first<span class="token punctuation">,</span> second<span class="token punctuation">}</span>
  <span class="token property">properties</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token operator">:</span> color
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> obj2
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>{
  numbers: {first, second}
  properties: {
    color: color
  }
} = obj2
</pre></div></div> <p>It’s common to extract values from at table and assign them the local variables that have the same name as the key. In order to avoid repetition we can use the <strong>:</strong> prefix operator:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token punctuation">{</span><span class="token operator">:</span><span class="token property">concat</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token property">insert</span><span class="token punctuation">}</span> <span class="token operator">=</span> table
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>{:concat, :insert} = table
</pre></div></div> <p>This is effectively the same as import, but we can rename fields we want to extract by mixing the syntax:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token punctuation">{</span><span class="token operator">:</span><span class="token property">mix</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token property">max</span><span class="token punctuation">,</span> <span class="token property">random</span><span class="token operator">:</span> rand<span class="token punctuation">}</span> <span class="token operator">=</span> math
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>{:mix, :max, random: rand} = math
</pre></div></div> <p>You can write default values while doing destructuring like:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code><span class="token punctuation">{</span><span class="token operator">:</span><span class="token property">name</span> <span class="token operator">=</span> <span class="token string">&quot;nameless&quot;</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token property">job</span> <span class="token operator">=</span> <span class="token string">&quot;jobless&quot;</span><span class="token punctuation">}</span> <span class="token operator">=</span> person
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>{:name = &quot;nameless&quot;, :job = &quot;jobless&quot;} = person
</pre></div></div> <h3 id="destructuring-in-other-places"><a href="#destructuring-in-other-places" class="header-anchor">#</a> Destructuring In Other Places</h3> <p>Destructuring can also show up in places where an assignment implicitly takes place. An example of this is a for loop:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>tuples <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">{</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">}</span>
  <span class="token punctuation">{</span><span class="token string">&quot;egg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;head&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">{</span>left<span class="token punctuation">,</span> right<span class="token punctuation">}</span> <span class="token keyword">in</span> <span class="token operator">*</span>tuples
  <span class="token function">print</span> left<span class="token punctuation">,</span> right
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>tuples = {
  {&quot;hello&quot;, &quot;world&quot;}
  {&quot;egg&quot;, &quot;head&quot;}
}

for {left, right} in *tuples
  print left, right
</pre></div></div> <p>We know each element in the array table is a two item tuple, so we can unpack it directly in the names clause of the for statement using a destructure.</p> <h2 id="function-stubs"><a href="#function-stubs" class="header-anchor">#</a> Function Stubs</h2> <p>It is common to pass a function from an object around as a value, for example, passing an instance method into a function as a callback. If the function expects the object it is operating on as the first argument then you must somehow bundle that object with the function so it can be called properly.</p> <p>The function stub syntax is a shorthand for creating a new closure function that bundles both the object and function. This new function calls the wrapped function in the correct context of the object.</p> <p>Its syntax is the same as calling an instance method with the \ operator but with no argument list provided.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>my_object <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token property">value</span><span class="token operator">:</span> <span class="token number">1000</span>
  <span class="token property">write</span><span class="token operator">:</span> <span class="token operator">=&gt;</span> <span class="token function">print</span> <span class="token string">&quot;the value:&quot;</span><span class="token punctuation">,</span> <span class="token variable">@value</span>
<span class="token punctuation">}</span>

run_callback <span class="token operator">=</span> <span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token operator">-&gt;</span>
  <span class="token function">print</span> <span class="token string">&quot;running callback...&quot;</span>
  func<span class="token operator">!</span>

<span class="token comment">-- this will not work:</span>
<span class="token comment">-- the function has to no reference to my_object</span>
run_callback my_object<span class="token punctuation">.</span>write

<span class="token comment">-- function stub syntax</span>
<span class="token comment">-- lets us bundle the object into a new function</span>
run_callback my_object<span class="token punctuation">\</span>write
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>my_object = {
  value: 1000
  write: =&gt; print &quot;the value:&quot;, @value
}

run_callback = (func)-&gt;
  print &quot;running callback...&quot;
  func!

-- this will not work:
-- the function has to no reference to my_object
run_callback my_object.write

-- function stub syntax
-- lets us bundle the object into a new function
run_callback my_object\write
</pre></div></div> <h2 id="the-using-clause-controlling-destructive-assignment"><a href="#the-using-clause-controlling-destructive-assignment" class="header-anchor">#</a> The Using Clause; Controlling Destructive Assignment</h2> <p>While lexical scoping can be a great help in reducing the complexity of the code we write, things can get unwieldy as the code size increases. Consider the following snippet:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>i <span class="token operator">=</span> <span class="token number">100</span>

<span class="token comment">-- many lines of code...</span>

my_func <span class="token operator">=</span> <span class="token operator">-&gt;</span>
  i <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token keyword">while</span> i <span class="token operator">&gt;</span> <span class="token number">0</span>
    <span class="token function">print</span> i
    i <span class="token operator">-=</span> <span class="token number">1</span>

my_func<span class="token operator">!</span>

<span class="token function">print</span> i <span class="token comment">-- will print 0</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>i = 100

-- many lines of code...

my_func = -&gt;
  i = 10
  while i &gt; 0
    print i
    i -= 1

my_func!

print i -- will print 0
</pre></div></div> <p>In my_func, we've overwritten the value of i mistakenly. In this example it is quite obvious, but consider a large, or foreign code base where it isn’t clear what names have already been declared.</p> <p>It would be helpful to say which variables from the enclosing scope we intend on change, in order to prevent us from changing others by accident.</p> <p>The using keyword lets us do that. using nil makes sure that no closed variables are overwritten in assignment. The using clause is placed after the argument list in a function, or in place of it if there are no arguments.</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>i <span class="token operator">=</span> <span class="token number">100</span>

my_func <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">using</span> <span class="token keyword">nil</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>
  i <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span> <span class="token comment">-- a new local variable is created here</span>

my_func<span class="token operator">!</span>
<span class="token function">print</span> i <span class="token comment">-- prints 100, i is unaffected</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>i = 100

my_func = (using nil)-&gt;
  i = &quot;hello&quot; -- a new local variable is created here

my_func!
print i -- prints 100, i is unaffected
</pre></div></div> <p>Multiple names can be separated by commas. Closure values can still be accessed, they just cant be modified:</p> <div class="language-moonscript extra-class"><pre class="language-moonscript"><code>tmp <span class="token operator">=</span> <span class="token number">1213</span>
i<span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span>

my_func <span class="token operator">=</span> <span class="token punctuation">(</span>add <span class="token keyword">using</span> k<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-&gt;</span>
  tmp <span class="token operator">=</span> tmp <span class="token operator">+</span> add <span class="token comment">-- a new local tmp is created</span>
  i <span class="token operator">+=</span> tmp
  k <span class="token operator">+=</span> tmp

my_func<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span>
<span class="token function">print</span> i<span class="token punctuation">,</span> k <span class="token comment">-- these have been updated</span>
</code></pre></div><div data-v-9e7c3d56><button class="button" data-v-9e7c3d56>Compile</button> <div style="display: none;" data-v-9e7c3d56><pre data-v-9e7c3d56>tmp = 1213
i, k = 100, 50

my_func = (add using k, i)-&gt;
  tmp = tmp + add -- a new local tmp is created
  i += tmp
  k += tmp

my_func(22)
print i, k -- these have been updated
</pre></div></div> <h2 id="licence-mit"><a href="#licence-mit" class="header-anchor">#</a> Licence: MIT</h2> <p>Copyright (c) 2022 Li Jin</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &quot;Software&quot;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p> <!----></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.6948427c.js" defer></script><script src="/assets/js/3.a65d0947.js" defer></script><script src="/assets/js/13.c43cbcb2.js" defer></script><script src="/assets/js/6.81a4f572.js" defer></script><script src="/assets/js/4.0fd3f51b.js" defer></script>
  </body>
</html>
